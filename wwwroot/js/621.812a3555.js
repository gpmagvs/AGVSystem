"use strict";(self["webpackChunkgpm_agvs"]=self["webpackChunkgpm_agvs"]||[]).push([[621],{52621:function(e,t,o){o.r(t),o.d(t,{default:function(){return q}});var r=o(79003);const n={class:"rack-status-view custom-tabs-head p-1"},s={class:"rack-container d-flex flex-row justify-content-center"};function a(e,t,o,a,l,i){const c=(0,r.resolveComponent)("RackStatus"),d=(0,r.resolveComponent)("b-tab"),m=(0,r.resolveComponent)("b-tabs");return(0,r.openBlock)(),(0,r.createElementBlock)("div",n,[(0,r.createVNode)(m,null,{default:(0,r.withCtx)((()=>[((0,r.openBlock)(!0),(0,r.createElementBlock)(r.Fragment,null,(0,r.renderList)(i.WIPData,(e=>((0,r.openBlock)(),(0,r.createBlock)(d,{key:e.WIPName,title:e.WIPName},{default:(0,r.withCtx)((()=>[(0,r.createElementVNode)("div",s,[(0,r.createVNode)(c,{rack_info:e},null,8,["rack_info"])])])),_:2},1032,["title"])))),128))])),_:1})])}const l=e=>((0,r.pushScopeId)("data-v-ef8969da"),e=e(),(0,r.popScopeId)(),e),i={class:"rack-status rounded m-3 p-1"},c={class:"my-1 d-flex flex-row"},d=l((()=>(0,r.createElementVNode)("div",{class:"p-1"},[(0,r.createElementVNode)("b",null,"水位")],-1))),m={class:"flex-fill p-2"};function u(e,t,o,n,s,a){const l=(0,r.resolveComponent)("el-progress"),u=(0,r.resolveComponent)("RackPort");return(0,r.openBlock)(),(0,r.createElementBlock)("div",i,[(0,r.createElementVNode)("h3",null,(0,r.toDisplayString)(o.rack_info.WIPName),1),(0,r.createElementVNode)("div",c,[d,(0,r.createElementVNode)("div",m,[(0,r.createVNode)(l,{"stroke-width":18,percentage:a.Level,"text-inside":""},{default:(0,r.withCtx)((()=>[(0,r.createElementVNode)("span",null,(0,r.toDisplayString)(this.HasCstPortNum)+"/"+(0,r.toDisplayString)(this.TotalPorts),1)])),_:1},8,["percentage"])])]),((0,r.openBlock)(!0),(0,r.createElementBlock)(r.Fragment,null,(0,r.renderList)(a.RowsArray(o.rack_info.Rows),(e=>((0,r.openBlock)(),(0,r.createElementBlock)("div",{class:"d-flex flex-row",key:"row-"+e},[((0,r.openBlock)(!0),(0,r.createElementBlock)(r.Fragment,null,(0,r.renderList)(o.rack_info.Columns,(t=>((0,r.openBlock)(),(0,r.createElementBlock)("div",{class:"d-flex flex-column",key:"col-"+t},[(0,r.createVNode)(u,{rack_name:o.rack_info.WIPName,port_info:a.GetPortByColRow(t-1,e-1)},null,8,["rack_name","port_info"])])))),128))])))),128))])}o(57658);const p={class:"rack-port"},k={class:"bg-primary text-light border-bottom"},S={class:"item"},f=(0,r.createElementVNode)("div",{class:"title"},"Carrier ID",-1),y={class:"values d-flex"},_={class:"item"},x=(0,r.createElementVNode)("div",{class:"title"},"Exist Sensor(Tray)",-1),E={class:"values d-flex"},C={class:"item"},v=(0,r.createElementVNode)("div",{class:"title"},"Exist Sensor(Rack)",-1),N={class:"values d-flex"},h={class:"item"},I=(0,r.createElementVNode)("div",{class:"title"},"Install Time",-1),g={class:"values"},V=(0,r.createElementVNode)("div",{class:"item"},[(0,r.createElementVNode)("div",{class:"title"}),(0,r.createElementVNode)("div",{class:"values"},"BBB")],-1),P={class:"item"};function D(e,t,o,n,s,a){const l=(0,r.resolveComponent)("el-input"),i=(0,r.resolveComponent)("el-tooltip"),c=(0,r.resolveComponent)("el-button");return(0,r.openBlock)(),(0,r.createElementBlock)("div",p,[(0,r.createElementVNode)("div",k,(0,r.toDisplayString)(a.PortNameDisplay),1),(0,r.createElementVNode)("div",S,[f,(0,r.createElementVNode)("div",y,[(0,r.createVNode)(l,{type:"text",disabled:"",size:"small",modelValue:o.port_info.CarrierID,"onUpdate:modelValue":t[0]||(t[0]=e=>o.port_info.CarrierID=e)},null,8,["modelValue"]),(0,r.createVNode)(i,{placement:"top-start",content:"複製到剪貼簿"},{default:(0,r.withCtx)((()=>[""!=o.port_info.CarrierID?((0,r.openBlock)(),(0,r.createElementBlock)("i",{key:0,onClick:t[1]||(t[1]=e=>a.CopyText(o.port_info.CarrierID)),class:"copy-button copy-icon bi bi-clipboard"})):(0,r.createCommentVNode)("",!0)])),_:1})])]),(0,r.createElementVNode)("div",_,[x,(0,r.createElementVNode)("div",E,[(0,r.createElementVNode)("div",{class:"exist-sensor round my-1",style:(0,r.normalizeStyle)(a.ExistSensorTray_1?s.ExistSensorOnStyle:s.ExistSensorOFFStyle),onClick:t[2]||(t[2]=e=>a.HandleExistSensorStateClick("tray",0))},null,4),(0,r.createElementVNode)("div",{class:"exist-sensor round my-1 mx-3",style:(0,r.normalizeStyle)(a.ExistSensorTray_2?s.ExistSensorOnStyle:s.ExistSensorOFFStyle),onClick:t[3]||(t[3]=e=>a.HandleExistSensorStateClick("tray",1))},null,4)])]),(0,r.createElementVNode)("div",C,[v,(0,r.createElementVNode)("div",N,[(0,r.createElementVNode)("div",{class:"exist-sensor round my-1",style:(0,r.normalizeStyle)(a.ExistSensorRack_1?s.ExistSensorOnStyle:s.ExistSensorOFFStyle),onClick:t[4]||(t[4]=e=>a.HandleExistSensorStateClick("rack",0))},null,4),(0,r.createElementVNode)("div",{class:"exist-sensor round my-1 mx-3",style:(0,r.normalizeStyle)(a.ExistSensorRack_2?s.ExistSensorOnStyle:s.ExistSensorOFFStyle),onClick:t[5]||(t[5]=e=>a.HandleExistSensorStateClick("rack",1))},null,4)])]),(0,r.createElementVNode)("div",h,[I,(0,r.createElementVNode)("div",g,(0,r.toDisplayString)(o.port_info.InstallTime),1)]),V,(0,r.createElementVNode)("div",P,[(0,r.createVNode)(c,{ref:"modify_btn",onClick:a.CstIDEditHandle,class:"m-1 w-100",type:"新增帳籍"==a.ModifyButtonText?"info":"success",size:"large"},{default:(0,r.withCtx)((()=>[(0,r.createTextVNode)((0,r.toDisplayString)(a.ModifyButtonText),1)])),_:1},8,["onClick","type"])])])}var T=o(18134),B=o.n(T),R=o(96e3),w=o(26666),b=o(56265),O=o.n(b),A=o(663),F=O().create({baseURL:A.Z.backend_host});async function H(e,t,o){var r=await F.post(`/api/WIP/ModifyCargoID?WIPID=${e}&PortID=${t}&NewCargoID=${o}`);return r.data}var L=o(24239),W=o(64491),$={props:{rack_name:{type:String,default:""},port_info:{type:Object,default(){return{CargoExist:!1,CarrierID:null,ExistSensorStates:{TRAY_1:!1,TRAY_2:!0,RACK_1:!1,RACK_2:!1},InstallTime:"0001-01-01T00:00:00",Properties:{ID:"0-0",Row:0,Column:0,IOLocation:{Tray_Sensor1:0,Tray_Sensor2:1,Box_Sensor1:2,Box_Sensor2:3}},RackPlacementState:0,TrayPlacementState:0}}}},data(){return{ExistSensorOnStyle:{backgroundColor:"lime"},ExistSensorOFFStyle:{backgroundColor:"rgb(255, 50, 0)"}}},computed:{PortNameDisplay(){return`${this.rack_name} | ${this.port_info.Properties.ID}`},ModifyButtonText(){return this.port_info.CarrierID&&""!=this.port_info.CarrierID?"修改帳籍":"新增帳籍"},ExistSensorTray_1(){return this.port_info.ExistSensorStates["TRAY_1"]},ExistSensorTray_2(){return this.port_info.ExistSensorStates["TRAY_2"]},ExistSensorRack_1(){return this.port_info.ExistSensorStates["RACK_1"]},ExistSensorRack_2(){return this.port_info.ExistSensorStates["RACK_2"]},IsDeveloperLogining(){return L.HP.getters.IsDeveloperLogining}},methods:{async HandleExistSensorStateClick(e="tray|rack",t=1){if(this.IsDeveloperLogining){var o=await W.k3.SetSensorState(this.rack_name,this.port_info.Properties.ID,e,t,!1);o.confirm||this.$swal.fire({text:"",title:`${o.message}`,icon:"info",showCancelButton:!1,confirmButtonText:"OK",customClass:"my-sweetalert"})}},CstIDEditHandle(){R.T.prompt("Carrier ID",{title:`${this.ModifyButtonText} : ${this.PortNameDisplay}`,draggable:!0,inputValue:this.port_info.CarrierID,type:"warning"}).then((e=>{console.info(e);var t=e.value?e.value:"";H(this.rack_name,this.port_info.Properties.ID,t)})).catch((()=>{}))},CopyText(e){const t=new(B())(".copy-button",{text:()=>e});t.on("success",(()=>{(0,w.bM)({title:e,message:"已複製到剪貼簿",duration:1500}),t.destroy()})),t.on("error",(()=>{t.destroy()}))}}},K=o(40089);const M=(0,K.Z)($,[["render",D]]);var z=M,Y={components:{RackPort:z},methods:{GetPortByColRow(e,t){var o=this.rack_info.Ports;return o.find((o=>o.Properties.Row==t&&o.Properties.Column==e))},RowsArray(e){let t=[];for(var o=e;o>=1;o--)t.push(o);return t}},props:{rack_info:{type:Object,default(){return{WIPName:"Rack-1",Rows:3,Columns:3,ColumnsTagMap:{0:[0],1:[1],2:[2]},Ports:[{CargoExist:!1,CarrierID:null,ExistSensorStates:{TRAY_1:!1,TRAY_2:!0,RACK_1:!1,RACK_2:!1},InstallTime:"0001-01-01T00:00:00",Properties:{ID:"0-0",Row:0,Column:0,IOLocation:{Tray_Sensor1:0,Tray_Sensor2:1,Box_Sensor1:2,Box_Sensor2:3}},RackPlacementState:0,TrayPlacementState:0}]}}}},computed:{TotalPorts(){return this.rack_info.Rows*this.rack_info.Columns},HasCstPortNum(){let e=0;for(let t=0;t<this.rack_info.Ports.length;t++)!0===this.rack_info.Ports[t].CargoExist&&e++;return e},Level(){return this.HasCstPortNum/this.TotalPorts*100}}};const j=(0,K.Z)(Y,[["render",u],["__scopeId","data-v-ef8969da"]]);var Z=j,U={components:{RackStatus:Z},data(){return{}},computed:{WIPData(){return L.jU.getters.WIPData}}};const G=(0,K.Z)(U,[["render",a]]);var q=G}}]);
//# sourceMappingURL=621.812a3555.js.map