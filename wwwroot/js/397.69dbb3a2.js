"use strict";(self["webpackChunkgpm_agvs"]=self["webpackChunkgpm_agvs"]||[]).push([[397],{10397:function(e,t,a){a.r(t),a.d(t,{default:function(){return O}});var o=a(79003);const l={class:"agv_show_on_map_design h-100"};function r(e,t,a,r,s,i){const n=(0,o.resolveComponent)("AGVDrawSetting"),p=(0,o.resolveComponent)("el-main"),d=(0,o.resolveComponent)("el-container");return(0,o.openBlock)(),(0,o.createElementBlock)("div",l,[(0,o.createVNode)(d,{class:"h-100"},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(p,{class:"bg-light p-2"},{default:(0,o.withCtx)((()=>[((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(i.agvNameList,(e=>((0,o.openBlock)(),(0,o.createBlock)(n,{key:e,agv_name:e},null,8,["agv_name"])))),128))])),_:1})])),_:1})])}const s=e=>((0,o.pushScopeId)("data-v-415fd998"),e=e(),(0,o.popScopeId)(),e),i={class:"agv_draw_setting"},n={class:"agv-id w-100 border-bottom mb-1 text-start text-primary"},p={class:"w-100 d-flex flex-row"},d=s((()=>(0,o.createElementVNode)("div",{class:"text-start text-primary mb-3"},"Preview",-1))),c=["id"];function g(e,t,a,l,r,s){const g=(0,o.resolveComponent)("el-input"),h=(0,o.resolveComponent)("el-form-item"),v=(0,o.resolveComponent)("el-color-picker"),u=(0,o.resolveComponent)("el-form"),m=(0,o.resolveComponent)("el-checkbox"),_=(0,o.resolveComponent)("el-aside"),w=(0,o.resolveComponent)("el-main"),C=(0,o.resolveComponent)("el-container");return(0,o.openBlock)(),(0,o.createElementBlock)("div",i,[(0,o.createVNode)(C,{class:"h-100"},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(_,{class:"properties-setting-container border bg-light",width:"50%"},{default:(0,o.withCtx)((()=>[(0,o.createElementVNode)("div",n,(0,o.toDisplayString)(a.agv_name),1),(0,o.createElementVNode)("div",p,[(0,o.createVNode)(u,{"label-width":"80","label-position":"left"},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(h,{label:"顯示名稱"},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(g,{type:"text",size:"small",modelValue:r.props.DisplayText,"onUpdate:modelValue":t[0]||(t[0]=e=>r.props.DisplayText=e),onInput:t[1]||(t[1]=e=>{s.ChangeTextOfAGV(e)})},null,8,["modelValue"])])),_:1}),(0,o.createVNode)(h,{label:"顏色"},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(v,{modelValue:r.props.DisplayColor,"onUpdate:modelValue":t[2]||(t[2]=e=>r.props.DisplayColor=e),onActiveChange:s.HandleAGVColorClicked},null,8,["modelValue","onActiveChange"])])),_:1}),(0,o.createVNode)(h,{label:"ICON"})])),_:1}),(0,o.createVNode)(u,{class:"mx-3","label-width":"120","label-position":"left"},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(h,{label:"顯示貨物狀態"},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(m)])),_:1}),(0,o.createVNode)(h,{label:"貨物-[框]圖示"}),(0,o.createVNode)(h,{label:"貨物-[Tray]圖示"})])),_:1})])])),_:1}),(0,o.createVNode)(w,{class:"border p-1",style:{"overflow-y":"hidden"}},{default:(0,o.withCtx)((()=>[d,(0,o.createElementVNode)("div",{id:s.map_id,class:"agv-preview-map border w-100",style:{height:"200px"}},null,8,c)])),_:1})])),_:1})])}var h=a(7686),v=a(88818),u=a(50563),m=a(98843),_=a(93292),w=a(1508),C=a(92949),f=a(79072),y=a(54404),V=a(93166),x=a(22205),S=a(7712),N=a(19966),Z=a(95320),b=a(53259),k={data(){return{map:void 0,agv_feature:void 0,_agvBodyFeature:void 0,_agvSaftyRegionFeature:void 0,props:new f.MV}},props:{agv_name:{type:String,default:"AGV_001"},raw_props:{type:f.MV,default(){var e=new f.MV;return e}}},computed:{map_id(){return"map-agv-preview-"+this.agv_name},featureStyle(){return this.agv_feature.getStyle()}},methods:{MapInit(){const e=new v.Z({code:"xkcd-image",units:"pixels",extent:[-20,-20,20,20]});this.agv_feature=new w.Z({geometry:new C.Z([0,0])}),this.agv_feature.setStyle((0,f.K$)(this.raw_props.DisplayText,this.raw_props.DisplayColor));const t=new y.ZP([[[-3,4],[3,4],[3,-4],[-3,-4]]]);this._agvBodyFeature=new w.Z(t),this._agvBodyFeature.setStyle(new x.ZP({fill:new S.Z({color:(0,f.xZ)(this.raw_props.DisplayColor,.6)}),stroke:new N.Z({color:"black",width:1})}));const a=new V.Z([0,0],5);this._agvSaftyRegionFeature=new w.Z(a);const o=(0,f.xZ)(this.raw_props.DisplayColor,.2);this._agvSaftyRegionFeature.setStyle(new x.ZP({fill:new S.Z({color:o}),stroke:new N.Z({color:o,width:1,lineDash:[5,2]})}));const l=new m.Z({source:new _.Z({features:[this.agv_feature,this._agvBodyFeature,this._agvSaftyRegionFeature]}),zIndex:2});this.map=new h.Z({layers:[l],target:this.map_id,view:new u.ZP({projection:e,center:[0,0],zoom:1,maxZoom:20})})},HandleAGVColorClicked(e){this.props.DisplayColor=e,this.ChangeColorOfAGV(e)},HandleAGVColorSelected(e){alert(e)},ChangeColorOfAGV(e){this.SetFeatureFillColor(this.agv_feature,e,!0),this.SetFeatureFillColor(this._agvBodyFeature,(0,f.xZ)(e,.4)),this.SetFeatureFillColor(this._agvSaftyRegionFeature,(0,f.xZ)(e,.2)),this.SaveToLocalStorage(!0)},ChangeTextOfAGV(e){var t=this.agv_feature.getStyle(),a=t.getText();a.setText(e),this.agv_feature.setStyle(t),this.SaveToLocalStorage()},SetFeatureFillColor(e,t,a=!1){var o=e.getStyle();if(a){var l=o.getText(),r=l.getBackgroundFill();r.setColor(t),l.setBackgroundFill(r)}else{r=o.getFill();r.setColor(t),o.setFill(r)}e.setStyle(o)},SaveToLocalStorage(e=!1){Z.p.commit("SaveAGVStyle",{agvname:this.agv_name,style:this.props}),e&&setTimeout((()=>{b.Z.emit("/rerender_agv_layer")}),500)}},mounted(){this.MapInit();var e=Z.p.getters.CustomAGVStyles;e[this.agv_name]?this.props=e[this.agv_name]:this.props=JSON.parse(JSON.stringify(this.raw_props)),this.ChangeTextOfAGV(this.props.DisplayText),this.ChangeColorOfAGV(this.props.DisplayColor)}},F=a(40089);const A=(0,F.Z)(k,[["render",g],["__scopeId","data-v-415fd998"]]);var B=A,D=a(24239),G={components:{AGVDrawSetting:B},methods:{SaveSetting(){}},computed:{agvNameList(){return D.sn.getters.AGVNameList}}};const T=(0,F.Z)(G,[["render",r]]);var O=T}}]);
//# sourceMappingURL=397.69dbb3a2.js.map