"use strict";(self["webpackChunkgpm_agvs"]=self["webpackChunkgpm_agvs"]||[]).push([[655],{32655:function(e,t,s){s.r(t),s.d(t,{default:function(){return q}});var o=s(79003);const r={class:"rack-status-view custom-tabs-head p-1"},n={class:"rack-container d-flex flex-row justify-content-center"};function a(e,t,s,a,i,l){const c=(0,o.resolveComponent)("RackStatus"),d=(0,o.resolveComponent)("b-tab"),m=(0,o.resolveComponent)("b-tabs");return(0,o.openBlock)(),(0,o.createElementBlock)("div",r,[(0,o.createVNode)(m,null,{default:(0,o.withCtx)((()=>[((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(l.WIPData,(e=>((0,o.openBlock)(),(0,o.createBlock)(d,{key:e.WIPName,title:e.WIPName},{default:(0,o.withCtx)((()=>[(0,o.createElementVNode)("div",n,[(0,o.createVNode)(c,{rack_info:e},null,8,["rack_info"])])])),_:2},1032,["title"])))),128))])),_:1})])}const i=e=>((0,o.pushScopeId)("data-v-55d85050"),e=e(),(0,o.popScopeId)(),e),l={class:"rack-status rounded m-3 p-1"},c={class:"my-1 d-flex flex-row"},d=i((()=>(0,o.createElementVNode)("div",{class:"p-1"},[(0,o.createElementVNode)("b",null,"水位")],-1))),m={class:"flex-fill p-2"};function x(e,t,s,r,n,a){const i=(0,o.resolveComponent)("el-progress"),x=(0,o.resolveComponent)("RackPort");return(0,o.openBlock)(),(0,o.createElementBlock)("div",l,[(0,o.createElementVNode)("h3",null,(0,o.toDisplayString)(s.rack_info.WIPName),1),(0,o.createElementVNode)("div",c,[d,(0,o.createElementVNode)("div",m,[(0,o.createVNode)(i,{"stroke-width":18,percentage:a.Level,"text-inside":""},{default:(0,o.withCtx)((()=>[(0,o.createElementVNode)("span",null,(0,o.toDisplayString)(this.HasCstPortNum)+"/"+(0,o.toDisplayString)(this.TotalPorts),1)])),_:1},8,["percentage"])])]),((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(a.RowsArray(s.rack_info.Rows),(e=>((0,o.openBlock)(),(0,o.createElementBlock)("div",{class:"d-flex flex-row",key:"row-"+e},[((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(s.rack_info.Columns,(t=>((0,o.openBlock)(),(0,o.createElementBlock)("div",{class:"d-flex flex-column",key:"col-"+t},[(0,o.createVNode)(x,{rack_name:s.rack_info.WIPName,port_info:a.GetPortByColRow(t-1,e-1)},null,8,["rack_name","port_info"])])))),128))])))),128))])}s(57658);const C={class:"rack-port"},u={class:"bg-primary text-light border-bottom"},p={class:"item"},E=(0,o.createElementVNode)("div",{class:"title"},"Carrier ID",-1),I={class:"values d-flex"},k={class:"item"},S=(0,o.createElementVNode)("div",{class:"title"},"Exist Sensor(Tray)",-1),y={class:"values d-flex"},N={class:"item"},f=(0,o.createElementVNode)("div",{class:"title"},"Exist Sensor(Rack)",-1),_={class:"values d-flex"},v={class:"item"},D=(0,o.createElementVNode)("div",{class:"title"},"Install Time",-1),T={class:"values"},h=(0,o.createElementVNode)("div",{class:"item"},[(0,o.createElementVNode)("div",{class:"title"}),(0,o.createElementVNode)("div",{class:"values"},"BBB")],-1),P={class:"item"};function g(e,t,s,r,n,a){const i=(0,o.resolveComponent)("el-input"),l=(0,o.resolveComponent)("el-tooltip"),c=(0,o.resolveComponent)("el-button");return(0,o.openBlock)(),(0,o.createElementBlock)("div",C,[(0,o.createElementVNode)("div",u,(0,o.toDisplayString)(a.PortNameDisplay),1),(0,o.createElementVNode)("div",p,[E,(0,o.createElementVNode)("div",I,[(0,o.createVNode)(i,{type:"text",disabled:"",size:"small",modelValue:s.port_info.CarrierID,"onUpdate:modelValue":t[0]||(t[0]=e=>s.port_info.CarrierID=e)},null,8,["modelValue"]),(0,o.createVNode)(l,{placement:"top-start",content:"複製到剪貼簿"},{default:(0,o.withCtx)((()=>[""!=s.port_info.CarrierID?((0,o.openBlock)(),(0,o.createElementBlock)("i",{key:0,onClick:t[1]||(t[1]=e=>a.CopyText(s.port_info.CarrierID)),class:"copy-button copy-icon bi bi-clipboard"})):(0,o.createCommentVNode)("",!0)])),_:1})])]),(0,o.createElementVNode)("div",k,[S,(0,o.createElementVNode)("div",y,[(0,o.createElementVNode)("div",{class:"exist-sensor round my-1",style:(0,o.normalizeStyle)(a.ExistSensorTray_1?n.ExistSensorOnStyle:n.ExistSensorOFFStyle),onClick:t[2]||(t[2]=e=>a.HandleExistSensorStateClick("tray",0))},null,4),(0,o.createElementVNode)("div",{class:"exist-sensor round my-1 mx-3",style:(0,o.normalizeStyle)(a.ExistSensorTray_2?n.ExistSensorOnStyle:n.ExistSensorOFFStyle),onClick:t[3]||(t[3]=e=>a.HandleExistSensorStateClick("tray",1))},null,4)])]),(0,o.createElementVNode)("div",N,[f,(0,o.createElementVNode)("div",_,[(0,o.createElementVNode)("div",{class:"exist-sensor round my-1",style:(0,o.normalizeStyle)(a.ExistSensorRack_1?n.ExistSensorOnStyle:n.ExistSensorOFFStyle),onClick:t[4]||(t[4]=e=>a.HandleExistSensorStateClick("rack",0))},null,4),(0,o.createElementVNode)("div",{class:"exist-sensor round my-1 mx-3",style:(0,o.normalizeStyle)(a.ExistSensorRack_2?n.ExistSensorOnStyle:n.ExistSensorOFFStyle),onClick:t[5]||(t[5]=e=>a.HandleExistSensorStateClick("rack",1))},null,4)])]),(0,o.createElementVNode)("div",v,[D,(0,o.createElementVNode)("div",T,(0,o.toDisplayString)(s.port_info.InstallTime),1)]),h,(0,o.createElementVNode)("div",P,[(0,o.createVNode)(c,{ref:"modify_btn",onClick:a.CstIDEditHandle,class:"m-1 w-100",type:"新增帳籍"==a.ModifyButtonText?"info":"success",size:"large"},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)((0,o.toDisplayString)(a.ModifyButtonText),1)])),_:1},8,["onClick","type"])])])}var R=s(18134),V=s.n(R),A=s(96e3),F=s(26666),w=s(56265),B=s.n(w),b=s(663),O=B().create({baseURL:b.Z.backend_host});async function W(e,t,s){var o=await O.post(`/api/WIP/ModifyCargoID?WIPID=${e}&PortID=${t}&NewCargoID=${s}`);return o.data}var H=s(24239),L=s(64491),$={props:{rack_name:{type:String,default:""},port_info:{type:Object,default(){return{CargoExist:!1,CarrierID:null,ExistSensorStates:{TRAY_1:!1,TRAY_2:!0,RACK_1:!1,RACK_2:!1},InstallTime:"0001-01-01T00:00:00",Properties:{ID:"0-0",Row:0,Column:0,IOLocation:{Tray_Sensor1:0,Tray_Sensor2:1,Box_Sensor1:2,Box_Sensor2:3}},RackPlacementState:0,TrayPlacementState:0}}}},data(){return{ExistSensorOnStyle:{backgroundColor:"lime"},ExistSensorOFFStyle:{backgroundColor:"rgb(255, 50, 0)"}}},computed:{PortNameDisplay(){return`${this.rack_name} | ${this.port_info.Properties.ID}`},ModifyButtonText(){return this.port_info.CarrierID&&""!=this.port_info.CarrierID?"修改帳籍":"新增帳籍"},ExistSensorTray_1(){return this.port_info.ExistSensorStates["TRAY_1"]},ExistSensorTray_2(){return this.port_info.ExistSensorStates["TRAY_2"]},ExistSensorRack_1(){return this.port_info.ExistSensorStates["RACK_1"]},ExistSensorRack_2(){return this.port_info.ExistSensorStates["RACK_2"]},IsDeveloperLogining(){return H.HP.getters.IsDeveloperLogining}},methods:{async HandleExistSensorStateClick(e="tray|rack",t=1){if(this.IsDeveloperLogining){var s=await L.k3.SetSensorState(this.rack_name,this.port_info.Properties.ID,e,t,!1);s.confirm||this.$swal.fire({text:"",title:`${s.message}`,icon:"info",showCancelButton:!1,confirmButtonText:"OK",customClass:"my-sweetalert"})}},CstIDEditHandle(){A.T.prompt("Carrier ID",{title:`${this.ModifyButtonText} : ${this.PortNameDisplay}`,draggable:!0,inputValue:this.port_info.CarrierID,type:"warning"}).then((e=>{console.info(e);var t=e.value?e.value:"";W(this.rack_name,this.port_info.Properties.ID,t)})).catch((()=>{}))},CopyText(e){const t=new(V())(".copy-button",{text:()=>e});t.on("success",(()=>{(0,F.bM)({title:e,message:"已複製到剪貼簿",duration:1500}),t.destroy()})),t.on("error",(()=>{t.destroy()}))}}},K=s(40089);const z=(0,K.Z)($,[["render",g]]);var M=z,Y={components:{RackPort:M},methods:{GetPortByColRow(e,t){var s=this.rack_info.Ports;return s.find((s=>s.Properties.Row==t&&s.Properties.Column==e))},RowsArray(e){let t=[];for(var s=e;s>=1;s--)t.push(s);return t}},props:{rack_info:{type:Object,default(){return{WIPName:"Rack-1",Rows:3,Columns:3,Ports:[{CargoExist:!1,CarrierID:null,ExistSensorStates:{TRAY_1:!1,TRAY_2:!0,RACK_1:!1,RACK_2:!1},InstallTime:"0001-01-01T00:00:00",Properties:{ID:"0-0",Row:0,Column:0,IOLocation:{Tray_Sensor1:0,Tray_Sensor2:1,Box_Sensor1:2,Box_Sensor2:3}},RackPlacementState:0,TrayPlacementState:0}]}}}},computed:{TotalPorts(){return this.rack_info.Rows*this.rack_info.Columns},HasCstPortNum(){let e=0;for(let t=0;t<this.rack_info.Ports.length;t++)!0===this.rack_info.Ports[t].CargoExist&&e++;return e},Level(){return this.HasCstPortNum/this.TotalPorts*100}}};const j=(0,K.Z)(Y,[["render",x],["__scopeId","data-v-55d85050"]]);var Z=j,U={components:{RackStatus:Z},data(){return{RacksData:[{WIPName:"Rack-1",Columns:3,Rows:3,Ports:[[{Name:"7",Index:7,CstID:"TA4F231111",CstExist:!0},{Name:"8",Index:8,CstID:"TA4F231111",CstExist:!0},{Name:"9",Index:9,CstID:"TA4F231111",CstExist:!1}],[{Name:"4",Index:4,CstID:"TA4F231111",CstExist:!0},{Name:"5",Index:5,CstID:"TA4F231111",CstExist:!0},{Name:"6",Index:6,CstID:"TA4F231111",CstExist:!1}],[{Name:"1",Index:1,CstID:"TA4F231111",CstExist:!0},{Name:"2",Index:2,CstID:"TA4F231111",CstExist:!0},{Name:"3",Index:3,CstID:"TA4F231111",CstExist:!1}]]},{WIPName:"Rack-2",Columns:4,Rows:3,Ports:[[{Name:"7",Index:9,CstID:"TA4F231111",CstExist:!0},{Name:"8",Index:10,CstID:"TA4F231111",CstExist:!1},{Name:"9",Index:11,CstExist:!1},{Name:"9",Index:12,CstID:"TA4F231111",CstExist:!1}],[{Name:"4",Index:5,CstID:"TA4F231111",CstExist:!0},{Name:"5",Index:6,CstID:"TA4F231111",CstExist:!1},{Name:"6",Index:7,CstExist:!1},{Name:"6",Index:8,CstID:"TA4F231111",CstExist:!1}],[{Name:"1",Index:1,CstID:"TA4F231111",CstExist:!0},{Name:"2",Index:2,CstID:"TA4F231111",CstExist:!1},{Name:"3",Index:3,CstExist:!1},{Name:"3",Index:4,CstID:"TA4F231111",CstExist:!1}]]},{WIPName:"Rack-3",Columns:2,Rows:3,Ports:[[{Name:"7",Index:5,CstID:"TA4F231111",CstExist:!1},{Name:"8",CstID:"TA4F231111",Index:6,CstExist:!0}],[{Name:"4",Index:3,CstID:"TA4F231111",CstExist:!1},{Name:"5",CstID:"TA4F231111",Index:4,CstExist:!0}],[{Name:"1",Index:1,CstID:"TA4F231111",CstExist:!1},{Name:"2",CstID:"TA4F231111",Index:2,CstExist:!0}]]}]}},computed:{WIPData(){return H.jU.getters.WIPData}}};const G=(0,K.Z)(U,[["render",a]]);var q=G}}]);
//# sourceMappingURL=655.a0ce1db0.js.map