{"version":3,"file":"js/373.21d7d36b.js","mappings":"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","sources":["webpack://gpm_agvs/./src/components/Map/AGVDesigner/AGVDisplaySettings.vue","webpack://gpm_agvs/./src/components/Map/AGVDesigner/AGVDrawSetting.vue","webpack://gpm_agvs/./src/components/General/ImageUploadButton.vue","webpack://gpm_agvs/./src/components/General/ImageUploadButton.vue?bf2e","webpack://gpm_agvs/./src/components/Map/AGVDesigner/AGVDrawSetting.vue?2e4f","webpack://gpm_agvs/./src/components/Map/AGVDesigner/AGVDisplaySettings.vue?805c"],"sourcesContent":["<template>\r\n    <div class=\"agv_show_on_map_design h-100\">\r\n        <el-container class=\"h-100\">\r\n            <!-- <el-header class=\"text-start p-2 border\" height=\"50px\">\r\n                <el-button type=\"primary\" @click=\"SaveSetting\">儲存設定</el-button>\r\n                <el-button type=\"danger\">取消</el-button>\r\n            </el-header> -->\r\n            <el-main class=\"bg-light p-2\">\r\n                <AGVDrawSetting v-for=\"name in agvNameList\" :key=\"name\" :agv_name=\"name\"></AGVDrawSetting>\r\n            </el-main>\r\n        </el-container>\r\n    </div>\r\n</template>\r\n<script>\r\nimport AGVDrawSetting from './AGVDrawSetting.vue';\r\nimport { agv_states_store } from '@/store';\r\nexport default {\r\n    components: {\r\n        AGVDrawSetting,\r\n    },\r\n    methods: {\r\n        SaveSetting() {\r\n\r\n        }\r\n    },\r\n    computed: {\r\n        agvNameList() {\r\n            return agv_states_store.getters.AGVNameList\r\n        }\r\n    },\r\n}\r\n</script>\r\n<style></style>","<!-- 設定AGV在地圖上的顯示 -->\r\n<!-- 可自行設定\r\n    1.AGV顏色 \r\n    2.AGV圖片ICON\r\n    3.框與Tray的圖片\r\n    4.是否要顯示Tray與框的圖示\r\n-->\r\n<template>\r\n    <div class=\"agv_draw_setting \">\r\n        <el-container class=\"h-100 \">\r\n            <el-aside class=\"properties-setting-container border bg-light\" width=\"50%\">\r\n                <div class=\"agv-id w-100 border-bottom mb-1 text-start text-primary\">{{ agv_name }}</div>\r\n                <div class=\"w-100 d-flex flex-row\">\r\n                    <el-form label-width=\"80\" label-position=\"left\">\r\n                        <el-form-item label=\"顯示名稱\">\r\n                            <el-input type=\"text\" size=\"small\" v-model=\"props.DisplayText\" @input=\"(text) => { ChangeTextOfAGV(text) }\"></el-input>\r\n                        </el-form-item>\r\n                        <el-form-item label=\"顏色\">\r\n                            <el-color-picker v-model=\"props.DisplayColor\" @active-change=\"HandleAGVColorClicked\"></el-color-picker>\r\n                        </el-form-item>\r\n                        <el-form-item label=\"ICON\">\r\n                            <div class=\"\">\r\n                                <ImageUploadButtonVue :backendUrl=\"iconUploadAPIEndPoint\" @OnFileUploaded=\"HandleImageUploaded\"></ImageUploadButtonVue>\r\n                            </div>\r\n                        </el-form-item>\r\n                    </el-form>\r\n                    <el-form class=\"mx-3\" label-width=\"120\" label-position=\"left\">\r\n                        <el-form-item label=\"顯示貨物狀態\">\r\n                            <el-checkbox></el-checkbox>\r\n                        </el-form-item>\r\n                        <el-form-item label=\"貨物-[框]圖示\"></el-form-item>\r\n                        <el-form-item label=\"貨物-[Tray]圖示\"></el-form-item>\r\n                    </el-form>\r\n                </div>\r\n            </el-aside>\r\n            <el-main class=\"border p-1\" style=\"overflow-y: hidden;\">\r\n                <div class=\"text-start text-primary mb-3\">Preview</div>\r\n                <div :id=\"map_id\"\r\n                    class=\"agv-preview-map border w-100\"\r\n                    style=\"height: 200px;\"> </div>\r\n            </el-main>\r\n        </el-container>\r\n    </div>\r\n</template>\r\n<script>\r\n\r\nimport Map from 'ol/Map.js';\r\nimport Projection from 'ol/proj/Projection.js';\r\nimport View from 'ol/View.js';\r\nimport { Vector as VectorLayer } from 'ol/layer.js';\r\nimport VectorSource from 'ol/source/Vector.js';\r\nimport Feature from 'ol/Feature.js';\r\nimport Point from 'ol/geom/Point.js';\r\nimport { AGVPointStyle, AgvDisplayProps, convertColorNameToRGBA } from '../mapjs'\r\nimport { Circle, Polygon } from 'ol/geom';\r\nimport { Fill, Stroke, Style, Circle as CircleStyle, Text } from 'ol/style';\r\n\r\nimport { MapStore } from '../store';\r\nimport { agv_states_store } from '@/store';\r\nimport bus from '@/event-bus';\r\nimport ImageUploadButtonVue from '@/components/General/ImageUploadButton.vue';\r\nimport param from '@/gpm_param.js'\r\nexport default {\r\n    components: {\r\n        ImageUploadButtonVue,\r\n    },\r\n    data() {\r\n        return {\r\n            map: undefined,\r\n            agv_feature: undefined,\r\n            _agvBodyFeature: undefined,\r\n            _agvSaftyRegionFeature: undefined,\r\n            props: new AgvDisplayProps(),\r\n            imageFile: null, // 存储选定的图像文件\r\n            imageUrl: null, // 存储图像的URL以供预览\r\n\r\n        }\r\n    },\r\n    props: {\r\n        agv_name: {\r\n            type: String,\r\n            default: \"AGV_001\"\r\n        },\r\n        raw_props: {\r\n            type: AgvDisplayProps,\r\n            default() {\r\n\r\n                var _props = new AgvDisplayProps()\r\n                return _props\r\n            }\r\n        },\r\n    },\r\n    computed: {\r\n        map_id() {\r\n            return 'map-agv-preview-' + this.agv_name\r\n        },\r\n        featureStyle() {\r\n            return this.agv_feature.getStyle();\r\n        },\r\n        iconUploadAPIEndPoint() {\r\n            return `${param.backend_host}/api/Map/AGVIconUpload?AGVName=${this.agv_name}`;\r\n\r\n        }\r\n    },\r\n    methods: {\r\n        MapInit() {\r\n            const projection = new Projection({\r\n                code: 'xkcd-image',\r\n                units: 'pixels',\r\n                extent: [-20, -20, 20, 20],\r\n            });\r\n\r\n            this.agv_feature = new Feature({\r\n                geometry: new Point([0, 0])\r\n            })\r\n            this.agv_feature.setStyle(AGVPointStyle(this.raw_props.DisplayText, this.raw_props.DisplayColor, '/AGVImages/' + this.agv_name + '-Icon.png'))\r\n\r\n            //AGV車體顯示\r\n            const _agvBodyPolygon = new Polygon([[[-3, 4], [3, 4], [3, -4], [-3, -4]]])\r\n            this._agvBodyFeature = new Feature(_agvBodyPolygon)\r\n            this._agvBodyFeature.setStyle(new Style({\r\n                fill: new Fill({ color: convertColorNameToRGBA(this.raw_props.DisplayColor, 0.6) }),\r\n                stroke: new Stroke({\r\n                    color: 'black',\r\n                    width: 1\r\n                })\r\n            }))\r\n            const _agvSaftyCircle = new Circle([0, 0], 5) //TODO 車輛安全區域半徑數據取得\r\n            this._agvSaftyRegionFeature = new Feature(_agvSaftyCircle)\r\n            const safyRegionColor = convertColorNameToRGBA(this.raw_props.DisplayColor, 0.2)\r\n            this._agvSaftyRegionFeature.setStyle(new Style({\r\n                fill: new Fill({ color: safyRegionColor }),\r\n                stroke: new Stroke({\r\n                    color: safyRegionColor, width: 1, lineDash: [5, 2]\r\n                })\r\n            }))\r\n            const layer = new VectorLayer({\r\n                source: new VectorSource({\r\n                    features: [this.agv_feature, this._agvBodyFeature, this._agvSaftyRegionFeature],\r\n                }),\r\n                zIndex: 2\r\n            })\r\n\r\n            this.map = new Map({\r\n                layers: [layer],\r\n                target: this.map_id,\r\n                view: new View({\r\n                    projection: projection,\r\n                    center: [0, 0],\r\n                    zoom: 1,\r\n                    maxZoom: 20\r\n                })\r\n            })\r\n        },\r\n        HandleAGVColorClicked(color) {\r\n            this.props.DisplayColor = color;\r\n            this.ChangeColorOfAGV(color)\r\n        },\r\n        HandleAGVColorSelected(c) {\r\n            alert(c)\r\n        },\r\n        ChangeColorOfAGV(color) {\r\n            this.SetFeatureFillColor(this.agv_feature, color, true);\r\n            this.SetFeatureFillColor(this._agvBodyFeature, convertColorNameToRGBA(color, 0.4));\r\n            this.SetFeatureFillColor(this._agvSaftyRegionFeature, convertColorNameToRGBA(color, 0.2));\r\n\r\n            this.SaveToLocalStorage(true);\r\n        },\r\n        ChangeTextOfAGV(str) {\r\n            var style = this.agv_feature.getStyle();\r\n            var text = style.getText();\r\n            text.setText(str);\r\n            this.agv_feature.setStyle(style);\r\n\r\n            this.SaveToLocalStorage();\r\n        },\r\n        SetFeatureFillColor(feature, color, isTextBg = false) {\r\n            var style = feature.getStyle();\r\n            if (isTextBg) {\r\n                var text = style.getText();\r\n                var fill = text.getBackgroundFill()\r\n                fill.setColor(color)\r\n                text.setBackgroundFill(fill);\r\n            } else {\r\n                var fill = style.getFill();\r\n                fill.setColor(color)\r\n                style.setFill(fill);\r\n            }\r\n            feature.setStyle(style)\r\n        },\r\n        SaveToLocalStorage(isChangedColor = false) {\r\n            MapStore.commit('SaveAGVStyle', { agvname: this.agv_name, style: this.props })\r\n            if (isChangedColor)\r\n                setTimeout(() => {\r\n                    bus.emit('/rerender_agv_layer')\r\n                }, 500)\r\n        },\r\n        HandleImageUploaded(payload) {\r\n            console.info(payload);\r\n            this.imageFile = payload.imageFile\r\n            var agv_img = new Image();\r\n            agv_img.onload = () => {\r\n                var size = [agv_img.width, agv_img.height]\r\n                this.agv_feature.setStyle(AGVPointStyle(this.raw_props.DisplayText, this.raw_props.DisplayColor, payload.imageUrl, size))\r\n            }\r\n            agv_img.src = payload.imageUrl\r\n\r\n        },\r\n\r\n\r\n    },\r\n    mounted() {\r\n        this.MapInit();\r\n\r\n        var localStyleStore = MapStore.getters.CustomAGVStyles;\r\n        if (localStyleStore[this.agv_name]) {\r\n            this.props = localStyleStore[this.agv_name]\r\n        } else\r\n            this.props = JSON.parse(JSON.stringify(this.raw_props))\r\n\r\n        this.ChangeTextOfAGV(this.props.DisplayText)\r\n        this.ChangeColorOfAGV(this.props.DisplayColor)\r\n    },\r\n}\r\n</script>\r\n<style lang=\"scss\" scoped>\r\n.agv_draw_setting {\r\n    height: 215px;\r\n    margin: 5px;\r\n\r\n    .properties-setting-container {\r\n        .agv-id {\r\n            font-size: 24px;\r\n        }\r\n\r\n        padding: 3px 8px;\r\n        border-top-left-radius: 10px;\r\n        border-bottom-left-radius: 4px;\r\n    }\r\n}\r\n</style>","<template>\r\n    <div class=\"image-upload-button\">\r\n        <!-- 上传图片按钮 -->\r\n        <el-button size=\"small\" type=\"button\" @click=\"triggerFileInput\">{{ buttonText }}</el-button>\r\n        <el-button v-if=\"imageFile != null\" size=\"small\" type=\"button\" @click=\"uploadToServer\">確認上傳</el-button>\r\n        <!-- 隐藏的文件输入，用于触发文件选择 -->\r\n        <input\r\n            type=\"file\"\r\n            ref=\"fileInput\"\r\n            @change=\"handleFileChange\"\r\n            accept=\"image/*\"\r\n            style=\"display: none;\" />\r\n        <!-- 图片预览 -->\r\n        <div v-if=\"imageUrl && showPreview\" class=\"image-preview\">\r\n            <img :src=\"imageUrl\" alt=\"Image preview\" />\r\n            <p>图片路径: {{ imageUrl }}</p>\r\n        </div>\r\n    </div>\r\n</template>\r\n<script>\r\n\r\nexport default {\r\n    props: {\r\n        showPreview: {\r\n            type: Boolean,\r\n            default: false\r\n        },\r\n        buttonText: {\r\n            type: String,\r\n            default: \"選擇圖片\"\r\n        },\r\n        backendUrl: {\r\n            type: String,\r\n            default: \"BACKEND_URL\"\r\n        }\r\n    },\r\n    data() {\r\n        return {\r\n            imageFile: null, // 存储选定的图像文件\r\n            imageUrl: null, // 存储图像的URL以供预览\r\n        };\r\n    },\r\n    methods: {\r\n        triggerFileInput() {\r\n            this.imageFile = null;\r\n            this.imageUrl = null;\r\n            this.$refs.fileInput.click();\r\n        },\r\n        handleFileChange(event) {\r\n            // 处理文件改变事件，获取文件并显示预览\r\n            this.imageFile = event.target.files[0];\r\n            if (this.imageFile) {\r\n                this.imageUrl = URL.createObjectURL(this.imageFile);\r\n                this.$emit('OnFileUploaded', {\r\n                    imageFile: this.imageFile,\r\n                    imageUrl: this.imageUrl\r\n                })\r\n            }\r\n        },\r\n        async uploadToServer() {\r\n            if (!this.imageFile) {\r\n                this.$swal.fire(\r\n                    {\r\n                        text: '',\r\n                        title: '請先選擇圖檔',\r\n                        icon: 'warning',\r\n                        showCancelButton: false,\r\n                        confirmButtonText: 'OK',\r\n                        customClass: 'my-sweetalert'\r\n                    })\r\n                return;\r\n            }\r\n            const formData = new FormData();\r\n            formData.append('image', this.imageFile);\r\n            try {\r\n                // 使用fetch API上传文件，这里需要替换为你的API端点\r\n                const response = await fetch(this.backendUrl, {\r\n                    method: 'POST',\r\n                    body: formData,\r\n                });\r\n\r\n                if (response.ok) {\r\n                    this.$swal.fire(\r\n                        {\r\n                            text: '',\r\n                            title: '上傳成功',\r\n                            icon: 'info',\r\n                            showCancelButton: false,\r\n                            confirmButtonText: 'OK',\r\n                            customClass: 'my-sweetalert'\r\n                        })\r\n                } else {\r\n                    console.log(response)\r\n                    this.$swal.fire(\r\n                        {\r\n                            text: `${response.url} : ${response.status}-${response.statusText}`,\r\n                            title: '上傳失敗',\r\n                            icon: 'error',\r\n                            showCancelButton: false,\r\n                            confirmButtonText: 'OK',\r\n                            customClass: 'my-sweetalert'\r\n                        })\r\n                }\r\n            } catch (error) {\r\n                console.error('上传错误:', error);\r\n                this.$swal.fire(\r\n                    {\r\n                        text: '',\r\n                        title: '上傳過程中發生錯誤',\r\n                        icon: 'error',\r\n                        showCancelButton: false,\r\n                        confirmButtonText: 'OK',\r\n                        customClass: 'my-sweetalert'\r\n                    })\r\n            }\r\n        },\r\n    },\r\n};\r\n</script>\r\n<style lang=\"scss\" scope>\r\n.image-upload-button {\r\n    .image-preview img {\r\n        width: 100%;\r\n        /* 或根据需要调整 */\r\n        height: auto;\r\n    }\r\n}\r\n</style>","import { render } from \"./ImageUploadButton.vue?vue&type=template&id=c08ed41e\"\nimport script from \"./ImageUploadButton.vue?vue&type=script&lang=js\"\nexport * from \"./ImageUploadButton.vue?vue&type=script&lang=js\"\n\nimport \"./ImageUploadButton.vue?vue&type=style&index=0&id=c08ed41e&lang=scss&scope=true\"\n\nimport exportComponent from \"../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","import { render } from \"./AGVDrawSetting.vue?vue&type=template&id=2bebb7c1&scoped=true\"\nimport script from \"./AGVDrawSetting.vue?vue&type=script&lang=js\"\nexport * from \"./AGVDrawSetting.vue?vue&type=script&lang=js\"\n\nimport \"./AGVDrawSetting.vue?vue&type=style&index=0&id=2bebb7c1&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-2bebb7c1\"]])\n\nexport default __exports__","import { render } from \"./AGVDisplaySettings.vue?vue&type=template&id=018da56d\"\nimport script from \"./AGVDisplaySettings.vue?vue&type=script&lang=js\"\nexport * from \"./AGVDisplaySettings.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"../../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"names":["class","_createElementBlock","_hoisted_1","_createVNode","_component_el_container","_component_el_main","_Fragment","_renderList","$options","agvNameList","name","_createBlock","_component_AGVDrawSetting","key","agv_name","_createElementVNode","_component_el_aside","width","_hoisted_2","_toDisplayString","$props","_hoisted_3","_component_el_form","_component_el_form_item","label","_component_el_input","type","size","$data","props","DisplayText","$event","onInput","_cache","text","ChangeTextOfAGV","_component_el_color_picker","DisplayColor","onActiveChange","HandleAGVColorClicked","_hoisted_4","_component_ImageUploadButtonVue","backendUrl","iconUploadAPIEndPoint","onOnFileUploaded","HandleImageUploaded","_component_el_checkbox","style","_hoisted_5","id","map_id","_component_el_button","onClick","triggerFileInput","buttonText","imageFile","uploadToServer","ref","onChange","args","handleFileChange","accept","imageUrl","showPreview","src","alt","Boolean","default","String","data","methods","this","$refs","fileInput","click","event","target","files","URL","createObjectURL","$emit","async","$swal","fire","title","icon","showCancelButton","confirmButtonText","customClass","formData","FormData","append","response","fetch","method","body","ok","console","log","url","status","statusText","error","__exports__","components","ImageUploadButtonVue","map","undefined","agv_feature","_agvBodyFeature","_agvSaftyRegionFeature","AgvDisplayProps","raw_props","_props","computed","featureStyle","getStyle","param","backend_host","MapInit","projection","Projection","code","units","extent","Feature","geometry","Point","setStyle","AGVPointStyle","_agvBodyPolygon","Polygon","Style","fill","Fill","color","convertColorNameToRGBA","stroke","Stroke","_agvSaftyCircle","Circle","safyRegionColor","lineDash","layer","VectorLayer","source","VectorSource","features","zIndex","Map","layers","view","View","center","zoom","maxZoom","ChangeColorOfAGV","HandleAGVColorSelected","c","alert","SetFeatureFillColor","SaveToLocalStorage","str","getText","setText","feature","isTextBg","getBackgroundFill","setColor","setBackgroundFill","getFill","setFill","isChangedColor","MapStore","commit","agvname","setTimeout","bus","emit","payload","info","agv_img","Image","onload","height","mounted","localStyleStore","getters","CustomAGVStyles","JSON","parse","stringify","AGVDrawSetting","SaveSetting","agv_states_store","AGVNameList","render"],"sourceRoot":""}