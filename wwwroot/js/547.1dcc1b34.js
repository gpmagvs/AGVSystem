"use strict";(self["webpackChunkgpm_agvs"]=self["webpackChunkgpm_agvs"]||[]).push([[547],{38547:function(t,e,s){s.r(e),s.d(e,{default:function(){return J}});var r=s(66252);const o={class:"rack-status-view custom-tabs-head p-1"},a={class:"rack-container d-flex flex-row justify-content-center"};function i(t,e,s,i,n,l){const c=(0,r.up)("RackStatus"),u=(0,r.up)("b-tab"),_=(0,r.up)("b-tabs");return(0,r.wg)(),(0,r.iD)("div",o,[(0,r.Wm)(_,null,{default:(0,r.w5)((()=>[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(l.WIPData,(t=>((0,r.wg)(),(0,r.j4)(u,{key:t.WIPName,title:t.WIPName},{default:(0,r.w5)((()=>[(0,r._)("div",a,[(0,r.Wm)(c,{rack_info:t},null,8,["rack_info"])])])),_:2},1032,["title"])))),128))])),_:1})])}var n=s(3577);const l=t=>((0,r.dD)("data-v-ef8969da"),t=t(),(0,r.Cn)(),t),c={class:"rack-status rounded m-3 p-1"},u={class:"my-1 d-flex flex-row"},_=l((()=>(0,r._)("div",{class:"p-1"},[(0,r._)("b",null,"水位")],-1))),d={class:"flex-fill p-2"};function p(t,e,s,o,a,i){const l=(0,r.up)("el-progress"),p=(0,r.up)("RackPort");return(0,r.wg)(),(0,r.iD)("div",c,[(0,r._)("h3",null,(0,n.zw)(s.rack_info.WIPName),1),(0,r._)("div",u,[_,(0,r._)("div",d,[(0,r.Wm)(l,{"stroke-width":18,percentage:i.Level,"text-inside":""},{default:(0,r.w5)((()=>[(0,r._)("span",null,(0,n.zw)(this.HasCstPortNum)+"/"+(0,n.zw)(this.TotalPorts),1)])),_:1},8,["percentage"])])]),((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(i.RowsArray(s.rack_info.Rows),(t=>((0,r.wg)(),(0,r.iD)("div",{class:"d-flex flex-row",key:"row-"+t},[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(s.rack_info.Columns,(e=>((0,r.wg)(),(0,r.iD)("div",{class:"d-flex flex-column",key:"col-"+e},[(0,r.Wm)(p,{rack_name:s.rack_info.WIPName,port_info:i.GetPortByColRow(e-1,t-1)},null,8,["rack_name","port_info"])])))),128))])))),128))])}s(57658);const f={class:"rack-port"},m={class:"bg-primary text-light border-bottom"},S={class:"item"},x=(0,r._)("div",{class:"title"},"Carrier ID",-1),y={class:"values d-flex"},k={class:"item"},v=(0,r._)("div",{class:"title"},"Exist Sensor(Tray)",-1),C={class:"values d-flex"},w={class:"item"},h=(0,r._)("div",{class:"title"},"Exist Sensor(Rack)",-1),g={class:"values d-flex"},I={class:"item"},D=(0,r._)("div",{class:"title"},"Install Time",-1),E={class:"values"},P=(0,r._)("div",{class:"item"},[(0,r._)("div",{class:"title"}),(0,r._)("div",{class:"values"},"BBB")],-1),R={class:"item"};function T(t,e,s,o,a,i){const l=(0,r.up)("el-input"),c=(0,r.up)("el-tooltip"),u=(0,r.up)("el-button");return(0,r.wg)(),(0,r.iD)("div",f,[(0,r._)("div",m,(0,n.zw)(i.PortNameDisplay),1),(0,r._)("div",S,[x,(0,r._)("div",y,[(0,r.Wm)(l,{type:"text",disabled:"",size:"small",modelValue:s.port_info.CarrierID,"onUpdate:modelValue":e[0]||(e[0]=t=>s.port_info.CarrierID=t)},null,8,["modelValue"]),(0,r.Wm)(c,{placement:"top-start",content:"複製到剪貼簿"},{default:(0,r.w5)((()=>[""!=s.port_info.CarrierID?((0,r.wg)(),(0,r.iD)("i",{key:0,onClick:e[1]||(e[1]=t=>i.CopyText(s.port_info.CarrierID)),class:"copy-button copy-icon bi bi-clipboard"})):(0,r.kq)("",!0)])),_:1})])]),(0,r._)("div",k,[v,(0,r._)("div",C,[(0,r._)("div",{class:"exist-sensor round my-1",style:(0,n.j5)(i.ExistSensorTray_1?a.ExistSensorOnStyle:a.ExistSensorOFFStyle),onClick:e[2]||(e[2]=t=>i.HandleExistSensorStateClick("tray",0))},null,4),(0,r._)("div",{class:"exist-sensor round my-1 mx-3",style:(0,n.j5)(i.ExistSensorTray_2?a.ExistSensorOnStyle:a.ExistSensorOFFStyle),onClick:e[3]||(e[3]=t=>i.HandleExistSensorStateClick("tray",1))},null,4)])]),(0,r._)("div",w,[h,(0,r._)("div",g,[(0,r._)("div",{class:"exist-sensor round my-1",style:(0,n.j5)(i.ExistSensorRack_1?a.ExistSensorOnStyle:a.ExistSensorOFFStyle),onClick:e[4]||(e[4]=t=>i.HandleExistSensorStateClick("rack",0))},null,4),(0,r._)("div",{class:"exist-sensor round my-1 mx-3",style:(0,n.j5)(i.ExistSensorRack_2?a.ExistSensorOnStyle:a.ExistSensorOFFStyle),onClick:e[5]||(e[5]=t=>i.HandleExistSensorStateClick("rack",1))},null,4)])]),(0,r._)("div",I,[D,(0,r._)("div",E,(0,n.zw)(s.port_info.InstallTime),1)]),P,(0,r._)("div",R,[(0,r.Wm)(u,{ref:"modify_btn",onClick:i.CstIDEditHandle,class:"m-1 w-100",type:"新增帳籍"==i.ModifyButtonText?"info":"success",size:"large"},{default:(0,r.w5)((()=>[(0,r.Uk)((0,n.zw)(i.ModifyButtonText),1)])),_:1},8,["onClick","type"])])])}var b=s(42152),A=s.n(b),W=s(10844),B=s(49996),O=s(9669),H=s.n(O),K=s(663),N=H().create({baseURL:K.Z.backend_host});async function Y(t,e,s){var r=await N.post(`/api/WIP/ModifyCargoID?WIPID=${t}&PortID=${e}&NewCargoID=${s}`);return r.data}var F=s(24239),j=s(64491),$={props:{rack_name:{type:String,default:""},port_info:{type:Object,default(){return{CargoExist:!1,CarrierID:null,ExistSensorStates:{TRAY_1:!1,TRAY_2:!0,RACK_1:!1,RACK_2:!1},InstallTime:"0001-01-01T00:00:00",Properties:{ID:"0-0",Row:0,Column:0,IOLocation:{Tray_Sensor1:0,Tray_Sensor2:1,Box_Sensor1:2,Box_Sensor2:3}},RackPlacementState:0,TrayPlacementState:0}}}},data(){return{ExistSensorOnStyle:{backgroundColor:"lime"},ExistSensorOFFStyle:{backgroundColor:"rgb(255, 50, 0)"}}},computed:{PortNameDisplay(){return`${this.rack_name} | ${this.port_info.Properties.ID}`},ModifyButtonText(){return this.port_info.CarrierID&&""!=this.port_info.CarrierID?"修改帳籍":"新增帳籍"},ExistSensorTray_1(){return 0===this.port_info.ExistSensorStates["TRAY_1"]||!this.port_info.ExistSensorStates["TRAY_1"]},ExistSensorTray_2(){return 0===this.port_info.ExistSensorStates["TRAY_2"]||!this.port_info.ExistSensorStates["TRAY_2"]},ExistSensorRack_1(){return 0===this.port_info.ExistSensorStates["RACK_1"]||!this.port_info.ExistSensorStates["RACK_1"]},ExistSensorRack_2(){return 0===this.port_info.ExistSensorStates["RACK_2"]||!this.port_info.ExistSensorStates["RACK_2"]},IsDeveloperLogining(){return F.HP.getters.IsDeveloperLogining}},methods:{async HandleExistSensorStateClick(t="tray|rack",e=1){if(this.IsDeveloperLogining){var s=await j.k3.SetSensorState(this.rack_name,this.port_info.Properties.ID,t,e,!1);s.confirm||this.$swal.fire({text:"",title:`${s.message}`,icon:"info",showCancelButton:!1,confirmButtonText:"OK",customClass:"my-sweetalert"})}},CstIDEditHandle(){W.T.prompt("Carrier ID",{title:`${this.ModifyButtonText} : ${this.PortNameDisplay}`,draggable:!0,inputValue:this.port_info.CarrierID,type:"warning"}).then((t=>{console.info(t);var e=t.value?t.value:"";Y(this.rack_name,this.port_info.Properties.ID,e)})).catch((()=>{}))},CopyText(t){const e=new(A())(".copy-button",{text:()=>t});e.on("success",(()=>{(0,B.bM)({title:t,message:"已複製到剪貼簿",duration:1500}),e.destroy()})),e.on("error",(()=>{e.destroy()}))}}},z=s(83744);const L=(0,z.Z)($,[["render",T]]);var M=L,U={components:{RackPort:M},methods:{GetPortByColRow(t,e){var s=this.rack_info.Ports;return s.find((s=>s.Properties.Row==e&&s.Properties.Column==t))},RowsArray(t){let e=[];for(var s=t;s>=1;s--)e.push(s);return e}},props:{rack_info:{type:Object,default(){return{WIPName:"Rack-1",Rows:3,Columns:3,ColumnsTagMap:{0:[0],1:[1],2:[2]},Ports:[{CargoExist:!1,CarrierID:null,ExistSensorStates:{TRAY_1:!1,TRAY_2:!0,RACK_1:!1,RACK_2:!1},InstallTime:"0001-01-01T00:00:00",Properties:{ID:"0-0",Row:0,Column:0,IOLocation:{Tray_Sensor1:0,Tray_Sensor2:1,Box_Sensor1:2,Box_Sensor2:3}},RackPlacementState:0,TrayPlacementState:0}]}}}},computed:{TotalPorts(){return this.rack_info.Rows*this.rack_info.Columns},HasCstPortNum(){let t=0;for(let e=0;e<this.rack_info.Ports.length;e++)!0===this.rack_info.Ports[e].CargoExist&&t++;return t},Level(){return this.HasCstPortNum/this.TotalPorts*100}}};const V=(0,z.Z)(U,[["render",p],["__scopeId","data-v-ef8969da"]]);var Z=V,G={components:{RackStatus:Z},data(){return{}},computed:{WIPData(){return F.jU.getters.WIPData}}};const q=(0,z.Z)(G,[["render",i]]);var J=q}}]);
//# sourceMappingURL=547.1dcc1b34.js.map