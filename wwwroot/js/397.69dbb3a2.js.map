{"version":3,"file":"js/397.69dbb3a2.js","mappings":"qLACSA,MAAM,gC,+KAAXC,EAAAA,EAAAA,oBAUM,MAVNC,EAUM,EATFC,EAAAA,EAAAA,aAQeC,EAAA,CARDJ,MAAM,SAAO,C,uBAKvB,IAEU,EAFVG,EAAAA,EAAAA,aAEUE,EAAA,CAFDL,MAAM,gBAAc,C,uBACT,IAA2B,uBAA3CC,EAAAA,EAAAA,oBAA0FK,EAAAA,SAAA,MAAAC,EAAAA,EAAAA,YAA3DC,EAAAC,aAARC,K,kBAAvBC,EAAAA,EAAAA,aAA0FC,EAAA,CAA7CC,IAAKH,EAAOI,SAAUJ,G,kICA1EV,MAAM,oB,GAGMA,MAAM,2D,GACNA,MAAM,yB,UAoBXe,EAAAA,EAAAA,oBAAuD,OAAlDf,MAAM,gCAA+B,WAAO,K,wXAxB7DC,EAAAA,EAAAA,oBA+BM,MA/BNC,EA+BM,EA9BFC,EAAAA,EAAAA,aA6BeC,EAAA,CA7BDJ,MAAM,SAAQ,C,uBACxB,IAoBW,EApBXG,EAAAA,EAAAA,aAoBWa,EAAA,CApBDhB,MAAM,+CAA+CiB,MAAM,O,wBACjE,IAAyF,EAAzFF,EAAAA,EAAAA,oBAAyF,MAAzFG,GAAyFC,EAAAA,EAAAA,iBAAjBC,EAAAN,UAAQ,IAChFC,EAAAA,EAAAA,oBAiBM,MAjBNM,EAiBM,EAhBFlB,EAAAA,EAAAA,aAQUmB,EAAA,CARD,cAAY,KAAK,iBAAe,Q,wBACrC,IAEe,EAFfnB,EAAAA,EAAAA,aAEeoB,EAAA,CAFDC,MAAM,QAAM,C,uBACtB,IAAuH,EAAvHrB,EAAAA,EAAAA,aAAuHsB,EAAA,CAA7GC,KAAK,OAAOC,KAAK,Q,WAAiBC,EAAAC,MAAMC,Y,qCAANF,EAAAC,MAAMC,YAAWC,GAAGC,QAAKC,EAAA,KAAAA,EAAA,GAAGC,IAAW1B,EAAA2B,gBAAgBD,EAAK,I,iCAE5G/B,EAAAA,EAAAA,aAEeoB,EAAA,CAFDC,MAAM,MAAI,C,uBACpB,IAAuG,EAAvGrB,EAAAA,EAAAA,aAAuGiC,EAAA,C,WAA7ER,EAAAC,MAAMQ,a,qCAANT,EAAAC,MAAMQ,aAAYN,GAAGO,eAAe9B,EAAA+B,uB,kDAElEpC,EAAAA,EAAAA,aAA0CoB,EAAA,CAA5BC,MAAM,Y,OAExBrB,EAAAA,EAAAA,aAMUmB,EAAA,CANDtB,MAAM,OAAO,cAAY,MAAM,iBAAe,Q,wBACnD,IAEe,EAFfG,EAAAA,EAAAA,aAEeoB,EAAA,CAFDC,MAAM,UAAQ,C,uBACxB,IAA2B,EAA3BrB,EAAAA,EAAAA,aAA2BqC,M,OAE/BrC,EAAAA,EAAAA,aAA8CoB,EAAA,CAAhCC,MAAM,cACpBrB,EAAAA,EAAAA,aAAiDoB,EAAA,CAAnCC,MAAM,mB,kBAIhCrB,EAAAA,EAAAA,aAMUE,EAAA,CANDL,MAAM,aAAayC,MAAA,yB,wBACxB,IAAuD,CAAvDC,GACA3B,EAAAA,EAAAA,oBAGM,OAHA4B,GAAInC,EAAAoC,OACN5C,MAAM,+BACNyC,MAAA,kB,oMAuBpB,GACII,OACI,MAAO,CACHC,SAAKC,EACLC,iBAAaD,EACbE,qBAAiBF,EACjBG,4BAAwBH,EACxBlB,MAAO,IAAIsB,EAAAA,GAEnB,EACAtB,MAAO,CACHf,SAAU,CACNY,KAAM0B,OACNC,QAAS,WAEbC,UAAW,CACP5B,KAAMyB,EAAAA,GACNE,UAEI,IAAIE,EAAS,IAAIJ,EAAAA,GACjB,OAAOI,CACX,IAGRC,SAAU,CACNZ,SACI,MAAO,mBAAqBa,KAAK3C,QACrC,EACA4C,eACI,OAAOD,KAAKT,YAAYW,UAC5B,GAEJC,QAAS,CACLC,UACI,MAAMC,EAAa,IAAIC,EAAAA,EAAW,CAC9BC,KAAM,aACNC,MAAO,SACPC,OAAQ,EAAE,IAAK,GAAI,GAAI,MAG3BT,KAAKT,YAAc,IAAImB,EAAAA,EAAQ,CAC3BC,SAAU,IAAIC,EAAAA,EAAM,CAAC,EAAG,MAE5BZ,KAAKT,YAAYsB,UAASC,EAAAA,EAAAA,IAAcd,KAAKH,UAAUxB,YAAa2B,KAAKH,UAAUjB,eAGnF,MAAMmC,EAAkB,IAAIC,EAAAA,GAAQ,CAAC,CAAC,EAAE,EAAG,GAAI,CAAC,EAAG,GAAI,CAAC,GAAI,GAAI,EAAE,GAAI,MACtEhB,KAAKR,gBAAkB,IAAIkB,EAAAA,EAAQK,GACnCf,KAAKR,gBAAgBqB,SAAS,IAAII,EAAAA,GAAM,CACpCC,KAAM,IAAIC,EAAAA,EAAK,CAAEC,OAAOC,EAAAA,EAAAA,IAAuBrB,KAAKH,UAAUjB,aAAc,MAC5E0C,OAAQ,IAAIC,EAAAA,EAAO,CACfH,MAAO,QACP5D,MAAO,OAGf,MAAMgE,EAAkB,IAAIC,EAAAA,EAAO,CAAC,EAAG,GAAI,GAC3CzB,KAAKP,uBAAyB,IAAIiB,EAAAA,EAAQc,GAC1C,MAAME,GAAkBL,EAAAA,EAAAA,IAAuBrB,KAAKH,UAAUjB,aAAc,IAC5EoB,KAAKP,uBAAuBoB,SAAS,IAAII,EAAAA,GAAM,CAC3CC,KAAM,IAAIC,EAAAA,EAAK,CAAEC,MAAOM,IACxBJ,OAAQ,IAAIC,EAAAA,EAAO,CACfH,MAAOM,EAAiBlE,MAAO,EAAGmE,SAAU,CAAC,EAAG,QAGxD,MAAMC,EAAQ,IAAIC,EAAAA,EAAY,CAC1BC,OAAQ,IAAIC,EAAAA,EAAa,CACrBC,SAAU,CAAChC,KAAKT,YAAaS,KAAKR,gBAAiBQ,KAAKP,0BAE5DwC,OAAQ,IAGZjC,KAAKX,IAAM,IAAI6C,EAAAA,EAAI,CACfC,OAAQ,CAACP,GACTQ,OAAQpC,KAAKb,OACbkD,KAAM,IAAIC,EAAAA,GAAK,CACXjC,WAAYA,EACZkC,OAAQ,CAAC,EAAG,GACZC,KAAM,EACNC,QAAS,MAGrB,EACA3D,sBAAsBsC,GAClBpB,KAAK5B,MAAMQ,aAAewC,EAC1BpB,KAAK0C,iBAAiBtB,EAC1B,EACAuB,uBAAuBC,GACnBC,MAAMD,EACV,EACAF,iBAAiBtB,GACbpB,KAAK8C,oBAAoB9C,KAAKT,YAAa6B,GAAO,GAClDpB,KAAK8C,oBAAoB9C,KAAKR,iBAAiB6B,EAAAA,EAAAA,IAAuBD,EAAO,KAC7EpB,KAAK8C,oBAAoB9C,KAAKP,wBAAwB4B,EAAAA,EAAAA,IAAuBD,EAAO,KAEpFpB,KAAK+C,oBAAmB,EAC5B,EACArE,gBAAgBsE,GACZ,IAAIhE,EAAQgB,KAAKT,YAAYW,WACzBzB,EAAOO,EAAMiE,UACjBxE,EAAKyE,QAAQF,GACbhD,KAAKT,YAAYsB,SAAS7B,GAE1BgB,KAAK+C,oBACT,EACAD,oBAAoBK,EAAS/B,EAAOgC,GAAW,GAC3C,IAAIpE,EAAQmE,EAAQjD,WACpB,GAAIkD,EAAU,CACV,IAAI3E,EAAOO,EAAMiE,UACb/B,EAAOzC,EAAK4E,oBAChBnC,EAAKoC,SAASlC,GACd3C,EAAK8E,kBAAkBrC,EAC3B,KAAO,CACCA,EAAOlC,EAAMwE,UACjBtC,EAAKoC,SAASlC,GACdpC,EAAMyE,QAAQvC,EAClB,CACAiC,EAAQtC,SAAS7B,EACrB,EACA+D,mBAAmBW,GAAiB,GAChCC,EAAAA,EAASC,OAAO,eAAgB,CAAEC,QAAS7D,KAAK3C,SAAU2B,MAAOgB,KAAK5B,QAClEsF,GACAI,YAAW,KACPC,EAAAA,EAAIC,KAAK,sBAAsB,GAChC,IACX,GAGJC,UACIjE,KAAKI,UAEL,IAAI8D,EAAkBP,EAAAA,EAASQ,QAAQC,gBACnCF,EAAgBlE,KAAK3C,UACrB2C,KAAK5B,MAAQ8F,EAAgBlE,KAAK3C,UAElC2C,KAAK5B,MAAQiG,KAAKC,MAAMD,KAAKE,UAAUvE,KAAKH,YAEhDG,KAAKtB,gBAAgBsB,KAAK5B,MAAMC,aAChC2B,KAAK0C,iBAAiB1C,KAAK5B,MAAMQ,aACrC,G,WC7LJ,MAAM4F,GAA2B,OAAgB,EAAQ,CAAC,CAAC,SAAS,GAAQ,CAAC,YAAY,qBAEzF,Q,WFOA,GACIC,WAAY,CACRC,eAAcA,GAElBvE,QAAS,CACLwE,cAEA,GAEJ5E,SAAU,CACN/C,cACI,OAAO4H,EAAAA,GAAiBT,QAAQU,WACpC,IGvBR,MAAM,GAA2B,OAAgB,EAAQ,CAAC,CAAC,SAASC,KAEpE,O","sources":["webpack://gpm_agvs/./src/components/Map/AGVDesigner/AGVDisplaySettings.vue","webpack://gpm_agvs/./src/components/Map/AGVDesigner/AGVDrawSetting.vue","webpack://gpm_agvs/./src/components/Map/AGVDesigner/AGVDrawSetting.vue?2e4f","webpack://gpm_agvs/./src/components/Map/AGVDesigner/AGVDisplaySettings.vue?805c"],"sourcesContent":["<template>\r\n    <div class=\"agv_show_on_map_design h-100\">\r\n        <el-container class=\"h-100\">\r\n            <!-- <el-header class=\"text-start p-2 border\" height=\"50px\">\r\n                <el-button type=\"primary\" @click=\"SaveSetting\">儲存設定</el-button>\r\n                <el-button type=\"danger\">取消</el-button>\r\n            </el-header> -->\r\n            <el-main class=\"bg-light p-2\">\r\n                <AGVDrawSetting v-for=\"name in agvNameList\" :key=\"name\" :agv_name=\"name\"></AGVDrawSetting>\r\n            </el-main>\r\n        </el-container>\r\n    </div>\r\n</template>\r\n<script>\r\nimport AGVDrawSetting from './AGVDrawSetting.vue';\r\nimport { agv_states_store } from '@/store';\r\nexport default {\r\n    components: {\r\n        AGVDrawSetting,\r\n    },\r\n    methods: {\r\n        SaveSetting() {\r\n\r\n        }\r\n    },\r\n    computed: {\r\n        agvNameList() {\r\n            return agv_states_store.getters.AGVNameList\r\n        }\r\n    },\r\n}\r\n</script>\r\n<style></style>","<!-- 設定AGV在地圖上的顯示 -->\r\n<!-- 可自行設定\r\n    1.AGV顏色 \r\n    2.AGV圖片ICON\r\n    3.框與Tray的圖片\r\n    4.是否要顯示Tray與框的圖示\r\n-->\r\n<template>\r\n    <div class=\"agv_draw_setting \">\r\n        <el-container class=\"h-100 \">\r\n            <el-aside class=\"properties-setting-container border bg-light\" width=\"50%\">\r\n                <div class=\"agv-id w-100 border-bottom mb-1 text-start text-primary\">{{ agv_name }}</div>\r\n                <div class=\"w-100 d-flex flex-row\">\r\n                    <el-form label-width=\"80\" label-position=\"left\">\r\n                        <el-form-item label=\"顯示名稱\">\r\n                            <el-input type=\"text\" size=\"small\" v-model=\"props.DisplayText\" @input=\"(text) => { ChangeTextOfAGV(text) }\"></el-input>\r\n                        </el-form-item>\r\n                        <el-form-item label=\"顏色\">\r\n                            <el-color-picker v-model=\"props.DisplayColor\" @active-change=\"HandleAGVColorClicked\"></el-color-picker>\r\n                        </el-form-item>\r\n                        <el-form-item label=\"ICON\"></el-form-item>\r\n                    </el-form>\r\n                    <el-form class=\"mx-3\" label-width=\"120\" label-position=\"left\">\r\n                        <el-form-item label=\"顯示貨物狀態\">\r\n                            <el-checkbox></el-checkbox>\r\n                        </el-form-item>\r\n                        <el-form-item label=\"貨物-[框]圖示\"></el-form-item>\r\n                        <el-form-item label=\"貨物-[Tray]圖示\"></el-form-item>\r\n                    </el-form>\r\n                </div>\r\n            </el-aside>\r\n            <el-main class=\"border p-1\" style=\"overflow-y: hidden;\">\r\n                <div class=\"text-start text-primary mb-3\">Preview</div>\r\n                <div :id=\"map_id\"\r\n                    class=\"agv-preview-map border w-100\"\r\n                    style=\"height: 200px;\">\r\n                </div>\r\n            </el-main>\r\n        </el-container>\r\n    </div>\r\n</template>\r\n<script>\r\n\r\nimport Map from 'ol/Map.js';\r\nimport Projection from 'ol/proj/Projection.js';\r\nimport View from 'ol/View.js';\r\nimport { Vector as VectorLayer } from 'ol/layer.js';\r\nimport VectorSource from 'ol/source/Vector.js';\r\nimport Feature from 'ol/Feature.js';\r\nimport Point from 'ol/geom/Point.js';\r\nimport { AGVPointStyle, AgvDisplayProps, convertColorNameToRGBA } from '../mapjs'\r\nimport { Circle, Polygon } from 'ol/geom';\r\nimport { Fill, Stroke, Style, Circle as CircleStyle, Text } from 'ol/style';\r\n\r\nimport { MapStore } from '../store';\r\nimport bus from '@/event-bus';\r\n\r\n\r\nexport default {\r\n    data() {\r\n        return {\r\n            map: undefined,\r\n            agv_feature: undefined,\r\n            _agvBodyFeature: undefined,\r\n            _agvSaftyRegionFeature: undefined,\r\n            props: new AgvDisplayProps()\r\n        }\r\n    },\r\n    props: {\r\n        agv_name: {\r\n            type: String,\r\n            default: \"AGV_001\"\r\n        },\r\n        raw_props: {\r\n            type: AgvDisplayProps,\r\n            default() {\r\n\r\n                var _props = new AgvDisplayProps()\r\n                return _props\r\n            }\r\n        }\r\n    },\r\n    computed: {\r\n        map_id() {\r\n            return 'map-agv-preview-' + this.agv_name\r\n        },\r\n        featureStyle() {\r\n            return this.agv_feature.getStyle();\r\n        }\r\n    },\r\n    methods: {\r\n        MapInit() {\r\n            const projection = new Projection({\r\n                code: 'xkcd-image',\r\n                units: 'pixels',\r\n                extent: [-20, -20, 20, 20],\r\n            });\r\n\r\n            this.agv_feature = new Feature({\r\n                geometry: new Point([0, 0])\r\n            })\r\n            this.agv_feature.setStyle(AGVPointStyle(this.raw_props.DisplayText, this.raw_props.DisplayColor))\r\n\r\n            //AGV車體顯示\r\n            const _agvBodyPolygon = new Polygon([[[-3, 4], [3, 4], [3, -4], [-3, -4]]])\r\n            this._agvBodyFeature = new Feature(_agvBodyPolygon)\r\n            this._agvBodyFeature.setStyle(new Style({\r\n                fill: new Fill({ color: convertColorNameToRGBA(this.raw_props.DisplayColor, 0.6) }),\r\n                stroke: new Stroke({\r\n                    color: 'black',\r\n                    width: 1\r\n                })\r\n            }))\r\n            const _agvSaftyCircle = new Circle([0, 0], 5) //TODO 車輛安全區域半徑數據取得\r\n            this._agvSaftyRegionFeature = new Feature(_agvSaftyCircle)\r\n            const safyRegionColor = convertColorNameToRGBA(this.raw_props.DisplayColor, 0.2)\r\n            this._agvSaftyRegionFeature.setStyle(new Style({\r\n                fill: new Fill({ color: safyRegionColor }),\r\n                stroke: new Stroke({\r\n                    color: safyRegionColor, width: 1, lineDash: [5, 2]\r\n                })\r\n            }))\r\n            const layer = new VectorLayer({\r\n                source: new VectorSource({\r\n                    features: [this.agv_feature, this._agvBodyFeature, this._agvSaftyRegionFeature],\r\n                }),\r\n                zIndex: 2\r\n            })\r\n\r\n            this.map = new Map({\r\n                layers: [layer],\r\n                target: this.map_id,\r\n                view: new View({\r\n                    projection: projection,\r\n                    center: [0, 0],\r\n                    zoom: 1,\r\n                    maxZoom: 20\r\n                })\r\n            })\r\n        },\r\n        HandleAGVColorClicked(color) {\r\n            this.props.DisplayColor = color;\r\n            this.ChangeColorOfAGV(color)\r\n        },\r\n        HandleAGVColorSelected(c) {\r\n            alert(c)\r\n        },\r\n        ChangeColorOfAGV(color) {\r\n            this.SetFeatureFillColor(this.agv_feature, color, true);\r\n            this.SetFeatureFillColor(this._agvBodyFeature, convertColorNameToRGBA(color, 0.4));\r\n            this.SetFeatureFillColor(this._agvSaftyRegionFeature, convertColorNameToRGBA(color, 0.2));\r\n\r\n            this.SaveToLocalStorage(true);\r\n        },\r\n        ChangeTextOfAGV(str) {\r\n            var style = this.agv_feature.getStyle();\r\n            var text = style.getText();\r\n            text.setText(str);\r\n            this.agv_feature.setStyle(style);\r\n\r\n            this.SaveToLocalStorage();\r\n        },\r\n        SetFeatureFillColor(feature, color, isTextBg = false) {\r\n            var style = feature.getStyle();\r\n            if (isTextBg) {\r\n                var text = style.getText();\r\n                var fill = text.getBackgroundFill()\r\n                fill.setColor(color)\r\n                text.setBackgroundFill(fill);\r\n            } else {\r\n                var fill = style.getFill();\r\n                fill.setColor(color)\r\n                style.setFill(fill);\r\n            }\r\n            feature.setStyle(style)\r\n        },\r\n        SaveToLocalStorage(isChangedColor = false) {\r\n            MapStore.commit('SaveAGVStyle', { agvname: this.agv_name, style: this.props })\r\n            if (isChangedColor)\r\n                setTimeout(() => {\r\n                    bus.emit('/rerender_agv_layer')\r\n                }, 500)\r\n        }\r\n\r\n    },\r\n    mounted() {\r\n        this.MapInit();\r\n\r\n        var localStyleStore = MapStore.getters.CustomAGVStyles;\r\n        if (localStyleStore[this.agv_name]) {\r\n            this.props = localStyleStore[this.agv_name]\r\n        } else\r\n            this.props = JSON.parse(JSON.stringify(this.raw_props))\r\n\r\n        this.ChangeTextOfAGV(this.props.DisplayText)\r\n        this.ChangeColorOfAGV(this.props.DisplayColor)\r\n    },\r\n}\r\n</script>\r\n<style lang=\"scss\" scoped>\r\n.agv_draw_setting {\r\n    height: 215px;\r\n    margin: 5px;\r\n\r\n    .properties-setting-container {\r\n        .agv-id {\r\n            font-size: 24px;\r\n        }\r\n\r\n        padding: 3px 8px;\r\n        border-top-left-radius: 10px;\r\n        border-bottom-left-radius: 4px;\r\n    }\r\n}\r\n</style>","import { render } from \"./AGVDrawSetting.vue?vue&type=template&id=415fd998&scoped=true\"\nimport script from \"./AGVDrawSetting.vue?vue&type=script&lang=js\"\nexport * from \"./AGVDrawSetting.vue?vue&type=script&lang=js\"\n\nimport \"./AGVDrawSetting.vue?vue&type=style&index=0&id=415fd998&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-415fd998\"]])\n\nexport default __exports__","import { render } from \"./AGVDisplaySettings.vue?vue&type=template&id=018da56d\"\nimport script from \"./AGVDisplaySettings.vue?vue&type=script&lang=js\"\nexport * from \"./AGVDisplaySettings.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"../../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"names":["class","_createElementBlock","_hoisted_1","_createVNode","_component_el_container","_component_el_main","_Fragment","_renderList","$options","agvNameList","name","_createBlock","_component_AGVDrawSetting","key","agv_name","_createElementVNode","_component_el_aside","width","_hoisted_2","_toDisplayString","$props","_hoisted_3","_component_el_form","_component_el_form_item","label","_component_el_input","type","size","$data","props","DisplayText","$event","onInput","_cache","text","ChangeTextOfAGV","_component_el_color_picker","DisplayColor","onActiveChange","HandleAGVColorClicked","_component_el_checkbox","style","_hoisted_4","id","map_id","data","map","undefined","agv_feature","_agvBodyFeature","_agvSaftyRegionFeature","AgvDisplayProps","String","default","raw_props","_props","computed","this","featureStyle","getStyle","methods","MapInit","projection","Projection","code","units","extent","Feature","geometry","Point","setStyle","AGVPointStyle","_agvBodyPolygon","Polygon","Style","fill","Fill","color","convertColorNameToRGBA","stroke","Stroke","_agvSaftyCircle","Circle","safyRegionColor","lineDash","layer","VectorLayer","source","VectorSource","features","zIndex","Map","layers","target","view","View","center","zoom","maxZoom","ChangeColorOfAGV","HandleAGVColorSelected","c","alert","SetFeatureFillColor","SaveToLocalStorage","str","getText","setText","feature","isTextBg","getBackgroundFill","setColor","setBackgroundFill","getFill","setFill","isChangedColor","MapStore","commit","agvname","setTimeout","bus","emit","mounted","localStyleStore","getters","CustomAGVStyles","JSON","parse","stringify","__exports__","components","AGVDrawSetting","SaveSetting","agv_states_store","AGVNameList","render"],"sourceRoot":""}