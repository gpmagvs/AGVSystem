"use strict";(self["webpackChunkgpm_agvs"]=self["webpackChunkgpm_agvs"]||[]).push([[386],{13386:function(t,e,s){s.r(e),s.d(e,{default:function(){return _t}});var a=s(66252);const r={class:"rack-status-view custom-tabs-head p-1"},o={class:"text-start"},i={class:"rack-container d-flex flex-row justify-content-center border"},n={key:1},l={class:"rack-container d-flex flex-row justify-content-center border"};function c(t,e,s,c,u,d){const p=(0,a.up)("el-option"),_=(0,a.up)("el-select"),f=(0,a.up)("RackStatus"),k=(0,a.up)("b-tab"),m=(0,a.up)("b-tabs");return(0,a.wg)(),(0,a.iD)("div",r,[(0,a._)("div",o,[(0,a.Wm)(_,{modelValue:u.display,"onUpdate:modelValue":e[0]||(e[0]=t=>u.display=t),style:{width:"120px"}},{default:(0,a.w5)((()=>[(0,a.Wm)(p,{label:"Tab",value:"tabs"}),(0,a.Wm)(p,{label:"整頁",value:"div"})])),_:1},8,["modelValue"])]),"tabs"==u.display?((0,a.wg)(),(0,a.j4)(m,{key:0},{default:(0,a.w5)((()=>[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(d.WIPData,(t=>((0,a.wg)(),(0,a.j4)(k,{key:t.WIPName,title:t.WIPName},{default:(0,a.w5)((()=>[(0,a._)("div",i,[(0,a.Wm)(f,{rack_info:t},null,8,["rack_info"])])])),_:2},1032,["title"])))),128))])),_:1})):((0,a.wg)(),(0,a.iD)("div",n,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(d.WIPData,(t=>((0,a.wg)(),(0,a.iD)("div",{class:"my-1",key:t.WIPName},[(0,a._)("div",l,[(0,a.Wm)(f,{rack_info:t},null,8,["rack_info"])])])))),128))]))])}var u=s(3577);const d={class:"rack-status rounded m-3 p-1"},p={class:"my-1 d-flex flex-row bg-light"},_={class:"w-50 text-start px-2"},f={class:"p-1"},k={class:"flex-fill p-2"},m={class:"ports-container"};function y(t,e,s,r,o,i){const n=(0,a.up)("el-progress"),l=(0,a.up)("RackPort");return(0,a.wg)(),(0,a.iD)("div",d,[(0,a._)("div",p,[(0,a._)("h3",_,(0,u.zw)(s.rack_info.WIPName),1),(0,a._)("div",f,[(0,a._)("b",null,(0,u.zw)(t.$t("Rack.Cargo_Spaces")),1)]),(0,a._)("div",k,[(0,a.Wm)(n,{"stroke-width":18,percentage:i.Level,"text-inside":"",striped:"","striped-flow":"",duration:40},{default:(0,a.w5)((()=>[(0,a._)("span",null,(0,u.zw)(this.HasCstPortNum)+"/"+(0,u.zw)(this.TotalPorts),1)])),_:1},8,["percentage"])])]),(0,a._)("div",m,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(i.RowsArray(s.rack_info.Rows),(t=>((0,a.wg)(),(0,a.iD)("div",{class:"d-flex flex-row",key:"row-"+t},[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(s.rack_info.Columns,(e=>((0,a.wg)(),(0,a.iD)("div",{class:"d-flex flex-column",key:"col-"+e},[(0,a.Wm)(l,{rack_name:s.rack_info.WIPName,port_info:i.GetPortByColRow(e-1,t-1),IsOvenAsRacks:s.rack_info.IsOvenAsRacks},null,8,["rack_name","port_info","IsOvenAsRacks"])])))),128))])))),128))])])}s(57658);var C=s(49963);const v=t=>((0,a.dD)("data-v-ebbaea4e"),t=t(),(0,a.Cn)(),t),x={class:"bg-light border-bottom d-flex py-1"},S={class:"text-danger bg-light w-100 text-start",style:{"max-height":"0",position:"relative",left:"3px",top:"0px"}},w=v((()=>(0,a._)("i",{class:"bi bi-exclamation"},null,-1))),g={class:"flex-fill text-start px-1"},I={key:0,class:"px-2"},h={class:"item"},D=v((()=>(0,a._)("div",{class:"title"},"Carrier ID",-1))),P={class:"values d-flex"},R={key:0,class:"item"},b=v((()=>(0,a._)("div",{class:"title"},"Exist Sensor(Tray)",-1))),T={class:"values d-flex"},E={key:1,class:"item"},O=v((()=>(0,a._)("div",{class:"title"},"Exist Sensor(Rack)",-1))),W={class:"values d-flex"},A={key:2,class:"item"},N=v((()=>(0,a._)("div",{class:"title"},"空/實框",-1))),$={class:"values"},j={key:3,class:"item"},z=v((()=>(0,a._)("div",{class:"title"},"Install Priority",-1))),F={class:"values"},H={class:"item"},B=v((()=>(0,a._)("div",{class:"title"},"Install Time",-1))),K={class:"values"},U={class:"item justify-content-center"},V={key:0,class:"w-100 d-flex justify-content-center"};function Y(t,e,s,r,o,i){const n=(0,a.up)("el-tag"),l=(0,a.up)("el-tooltip"),c=(0,a.up)("el-radio-button"),d=(0,a.up)("el-radio-group"),p=(0,a.up)("el-input"),_=(0,a.up)("el-button");return(0,a.wg)(),(0,a.iD)("div",{class:(0,u.C_)(["rack-port",i.ProductQualityClassName])},[(0,a._)("div",x,[(0,a.wy)((0,a._)("div",S,[w,(0,a.Uk)(" "+(0,u.zw)(t.$t("Rack.Sensor_Flash")),1)],512),[[C.F8,i.AnySensorFlash]]),(0,a._)("span",g,[(0,a.Wm)(n,{effect:"dark"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,u.zw)(i.PortNameDisplay),1)])),_:1})]),s.IsOvenAsRacks?(0,a.kq)("",!0):((0,a.wg)(),(0,a.iD)("div",I,[0==s.port_info.Properties.ProductionQualityStore?((0,a.wg)(),(0,a.j4)(n,{key:0,class:(0,u.C_)(i.ProductQualityClassName+" text-dark"),effect:"dark"},{default:(0,a.w5)((()=>[(0,a.Uk)("NORMAL PORT")])),_:1},8,["class"])):((0,a.wg)(),(0,a.j4)(n,{key:1,class:(0,u.C_)(i.ProductQualityClassName+" text-dark"),effect:"dark"},{default:(0,a.w5)((()=>[(0,a.Uk)("NG PORT")])),_:1},8,["class"]))]))]),(0,a._)("div",h,[D,(0,a._)("div",P,[(0,a.Wm)(n,{size:"large",effect:"dark",type:""==s.port_info.CarrierID?"info":"primary",style:{width:"135px"}},{default:(0,a.w5)((()=>[(0,a.Uk)((0,u.zw)(s.port_info.CarrierID),1)])),_:1},8,["type"]),(0,a.Wm)(l,{placement:"top-start",content:t.$t("Rack.copy")},{default:(0,a.w5)((()=>[""!=s.port_info.CarrierID?((0,a.wg)(),(0,a.iD)("i",{key:0,onClick:e[0]||(e[0]=t=>i.CopyText(s.port_info.CarrierID)),class:"copy-button copy-icon bi bi-clipboard"})):(0,a.kq)("",!0)])),_:1},8,["content"])])]),s.IsOvenAsRacks||2!=s.port_info.Properties.CargoTypeStore&&0!=s.port_info.Properties.CargoTypeStore?(0,a.kq)("",!0):((0,a.wg)(),(0,a.iD)("div",R,[b,(0,a._)("div",T,[(0,a._)("div",{class:"exist-sensor round my-1",style:(0,u.j5)(i.ExistSensorTray_1?o.ExistSensorOnStyle:o.ExistSensorOFFStyle),onClick:e[1]||(e[1]=t=>i.HandleExistSensorStateClick("tray",0))},null,4),(0,a._)("div",{class:"exist-sensor round my-1 mx-3",style:(0,u.j5)(i.ExistSensorTray_2?o.ExistSensorOnStyle:o.ExistSensorOFFStyle),onClick:e[2]||(e[2]=t=>i.HandleExistSensorStateClick("tray",1))},null,4)])])),s.IsOvenAsRacks||2!=s.port_info.Properties.CargoTypeStore&&1!=s.port_info.Properties.CargoTypeStore?(0,a.kq)("",!0):((0,a.wg)(),(0,a.iD)("div",E,[O,(0,a._)("div",W,[(0,a._)("div",{class:"exist-sensor round my-1",style:(0,u.j5)(i.ExistSensorRack_1?o.ExistSensorOnStyle:o.ExistSensorOFFStyle),onClick:e[3]||(e[3]=t=>i.HandleExistSensorStateClick("rack",0))},null,4),(0,a._)("div",{class:"exist-sensor round my-1 mx-3",style:(0,u.j5)(i.ExistSensorRack_2?o.ExistSensorOnStyle:o.ExistSensorOFFStyle),onClick:e[4]||(e[4]=t=>i.HandleExistSensorStateClick("rack",1))},null,4)])])),s.IsOvenAsRacks?((0,a.wg)(),(0,a.iD)("div",A,[N,(0,a._)("div",$,[(0,a.Wm)(d,{disabled:o.radioGroupDisable,size:"large",modelValue:s.port_info.RackContentState,"onUpdate:modelValue":e[5]||(e[5]=t=>s.port_info.RackContentState=t),fill:"rgb(8, 87, 60)"},{default:(0,a.w5)((()=>[(0,a.Wm)(c,{onClick:i.EmptyContentClick,value:0,label:"空框"},null,8,["onClick"]),(0,a.Wm)(c,{onClick:i.FullContentClick,value:1,label:"實框"},null,8,["onClick"])])),_:1},8,["disabled","modelValue"])])])):(0,a.kq)("",!0),s.IsOvenAsRacks?(0,a.kq)("",!0):((0,a.wg)(),(0,a.iD)("div",j,[z,(0,a._)("div",F,[(0,a.Wm)(p,{type:"text",size:"small",modelValue:s.port_info.Properties.StoragePriority,"onUpdate:modelValue":e[6]||(e[6]=t=>s.port_info.Properties.StoragePriority=t)},null,8,["modelValue"])])])),(0,a._)("div",H,[B,(0,a._)("div",K,(0,u.zw)(s.port_info.InstallTime),1)]),(0,a._)("div",U,[i.IsCarrierIDExist?((0,a.wg)(),(0,a.iD)("div",V,[(0,a.Wm)(_,{ref:"modify_btn",onClick:i.CstIDEditHandle,type:"success"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,u.zw)(t.$t("Rack.Edit_ID")),1)])),_:1},8,["onClick"]),(0,a.Wm)(_,{onClick:i.RemoveCSTID,type:"danger"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,u.zw)(t.$t("Rack.Remove_ID")),1)])),_:1},8,["onClick"])])):((0,a.wg)(),(0,a.j4)(_,{key:1,onClick:i.CstIDEditHandle,class:"m-1",type:"info"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,u.zw)(t.$t("Rack.Creat_ID")),1)])),_:1},8,["onClick"]))])],2)}var G=s(42152),L=s.n(G),q=s(10844),M=s(49996),Q=s(9669),Z=s.n(Q),J=s(663),X=Z().create({baseURL:J.Z.backend_host});async function tt(t,e,s){var a=await X.post(`/api/WIP/ModifyCargoID?WIPID=${t}&PortID=${e}&NewCargoID=${s}`);return a.data}async function et(t,e){var s=await X.post(`/api/WIP/RemoveCargoID?WIPID=${t}&PortID=${e}`);return s.data}var st=s(25044),at=s(64491),rt={props:{rack_name:{type:String,default:""},port_info:{type:Object,default(){return{CargoExist:!1,CarrierID:null,ExistSensorStates:{TRAY_1:!1,TRAY_2:!0,RACK_1:!1,RACK_2:!1},InstallTime:"0001-01-01T00:00:00",Properties:{ID:"0-0",Row:0,Column:0,ProductionQualityStore:0,CargoTypeStore:2,IOLocation:{Tray_Sensor1:0,Tray_Sensor2:1,Box_Sensor1:2,Box_Sensor2:3},StoragePriority:0},RackPlacementState:0,TrayPlacementState:0}}},IsOvenAsRacks:{type:Boolean,default:!1}},data(){return{ExistSensorOnStyle:{backgroundColor:"lime"},ExistSensorOFFStyle:{backgroundColor:"rgb(255, 50, 0)"},selectedRackContentType:"",radioGroupDisable:!1}},computed:{ProductQualityClassName(){return this.IsOvenAsRacks?"oven-port":0==this.port_info.Properties.ProductionQualityStore?"ok-port":"ng-port"},PortNameDisplay(){return`${this.port_info.NickName} | ${this.port_info.Properties.ID}`},IsCarrierIDExist(){return this.port_info.CarrierID&&""!=this.port_info.CarrierID},ModifyButtonText(){return this.IsCarrierIDExist?"修改帳籍":"新增帳籍"},ExistSensorTray_1(){return 0!=this.port_info.ExistSensorStates["TRAY_1"]},ExistSensorTray_2(){return 0!=this.port_info.ExistSensorStates["TRAY_2"]},ExistSensorRack_1(){return 0!=this.port_info.ExistSensorStates["RACK_1"]},ExistSensorRack_2(){return 0!=this.port_info.ExistSensorStates["RACK_2"]},AnySensorFlash(){var t=Object.values(this.port_info.ExistSensorStates),e=t.filter((t=>2==t));return 0!=e.length},IsDeveloperLogining(){return st.HP.getters.IsDeveloperLogining}},methods:{async HandleExistSensorStateClick(t="tray|rack",e=1){if(this.IsDeveloperLogining){var s=await at.k3.SetSensorState(this.rack_name,this.port_info.Properties.ID,t,e,!1);s.confirm||this.$swal.fire({text:"",title:`${s.message}`,icon:"info",showCancelButton:!1,confirmButtonText:"OK",customClass:"my-sweetalert"})}},CstIDEditHandle(){q.T.prompt("Carrier ID",{title:`${this.ModifyButtonText} : ${this.PortNameDisplay}`,draggable:!0,inputValue:this.port_info.CarrierID,type:"warning",confirmButtonText:"修改",inputErrorMessage:"帳籍ID不得為空",inputPlaceholder:"請輸入ID",inputValidator:t=>""!=t}).then((t=>{console.info(t);var e=t.value?t.value:"";tt(this.rack_name,this.port_info.Properties.ID,e),this.$message({message:"帳籍已修改。",type:"success"})})).catch((()=>{}))},RemoveCSTID(){this.$swal.fire({text:`確定要移除帳籍-[${this.port_info.CarrierID}] ?`,title:"移除帳籍確認",icon:"question",showCancelButton:!0,confirmButtonText:"OK",customClass:"my-sweetalert"}).then((t=>{t.isConfirmed&&(et(this.rack_name,this.port_info.Properties.ID),this.$message({message:"帳籍已移除。"}))}))},CopyText(t){const e=new(L())(".copy-button",{text:()=>t});e.on("success",(()=>{(0,M.bM)({title:t,message:"已複製到剪貼簿",duration:1500}),e.destroy()})),e.on("error",(()=>{e.destroy()}))},async EmptyContentClick(){this.radioGroupDisable=!0,await(0,at.Kz)(this.port_info.TagNumbers[0],!0),await(0,at.hE)(this.port_info.TagNumbers[0],!1),this.radioGroupDisable=!1},async FullContentClick(){this.radioGroupDisable=!0,await(0,at.hE)(this.port_info.TagNumbers[0],!0),await(0,at.Kz)(this.port_info.TagNumbers[0],!1),this.radioGroupDisable=!1}}},ot=s(83744);const it=(0,ot.Z)(rt,[["render",Y],["__scopeId","data-v-ebbaea4e"]]);var nt=it,lt={components:{RackPort:nt},methods:{GetPortByColRow(t,e){var s=this.rack_info.Ports;return s.find((s=>s.Properties.Row==e&&s.Properties.Column==t))},RowsArray(t){let e=[];for(var s=t;s>=1;s--)e.push(s);return e}},props:{rack_info:{type:Object,default(){return{WIPName:"Rack-1",Rows:3,Columns:3,ColumnsTagMap:{0:[0],1:[1],2:[2]},Ports:[{CargoExist:!1,CarrierID:null,ExistSensorStates:{TRAY_1:!1,TRAY_2:!0,RACK_1:!1,RACK_2:!1},InstallTime:"0001-01-01T00:00:00",Properties:{ID:"0-0",Row:0,Column:0,IOLocation:{Tray_Sensor1:0,Tray_Sensor2:1,Box_Sensor1:2,Box_Sensor2:3}},RackPlacementState:0,TrayPlacementState:0}]}}}},computed:{TotalPorts(){return this.rack_info.Rows*this.rack_info.Columns},HasCstPortNum(){let t=0;for(let e=0;e<this.rack_info.Ports.length;e++)!0===this.rack_info.Ports[e].CargoExist&&t++;return t},Level(){return this.HasCstPortNum/this.TotalPorts*100}}};const ct=(0,ot.Z)(lt,[["render",y],["__scopeId","data-v-cd72107e"]]);var ut=ct,dt={components:{RackStatus:ut},data(){return{display:"div"}},computed:{WIPData(){return st.jU.state.WIPsData}},watch:{display(t){localStorage.setItem("wips-display-mode",t)}},mounted(){var t=localStorage.getItem("wips-display-mode");t&&(this.display=t)}};const pt=(0,ot.Z)(dt,[["render",c]]);var _t=pt}}]);
//# sourceMappingURL=386.cb837cba.js.map