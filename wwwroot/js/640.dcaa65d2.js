"use strict";(self["webpackChunkgpm_agvs"]=self["webpackChunkgpm_agvs"]||[]).push([[640],{51640:function(e,l,a){a.r(l),a.d(l,{default:function(){return j}});var t=a(66252),o=a(49963),n=a(3577);const d=e=>((0,t.dD)("data-v-4268033e"),e=e(),(0,t.Cn)(),e),s={class:"equipment-manager border-start border-end"},i={class:"w-100 d-flex"},_={key:0,class:"text-start px-1 flex-fill"},u={key:1,class:"text-start px-1 flex-fill"},m={class:""},r={class:"w-100 d-flex flex-row"},c={class:"w-100"},p={class:"d-flex w-100 mx-1"},w={class:"w-50 border p-2"},g=d((()=>(0,t._)("h5",{class:"w-100 border rounded bg-primary text-light"},"INPUT",-1))),q={class:"w-50 border p-2 mx-1"},V=d((()=>(0,t._)("h5",{class:"w-100 border rounded bg-info text-light"},"OUTPUT",-1))),h={class:"hs-signals d-flex"},f=d((()=>(0,t._)("div",{class:"mx-3"},"交握訊號-EQ",-1))),C={class:"hs-signals d-flex"},b=d((()=>(0,t._)("div",{class:"mx-3"},"交握訊號-AGV",-1)));function E(e,l,a,d,E,W){const U=(0,t.up)("b-button"),O=(0,t.up)("el-radio-button"),v=(0,t.up)("el-radio-group"),D=(0,t.up)("EqGroupEditor"),y=(0,t.up)("el-table-column"),k=(0,t.up)("b-form-input"),S=(0,t.up)("el-button"),H=(0,t.up)("el-option"),A=(0,t.up)("el-select"),T=(0,t.up)("el-checkbox"),R=(0,t.up)("el-input"),I=(0,t.up)("el-table"),N=(0,t.up)("el-divider"),P=(0,t.up)("el-form-item"),Q=(0,t.up)("el-form"),L=(0,t.up)("el-drawer"),x=(0,t.Q2)("loading");return(0,t.wy)(((0,t.wg)(),(0,t.iD)("div",s,[(0,t._)("div",i,["eq-list"==E.displayMode?((0,t.wg)(),(0,t.iD)("p",_,[(0,t.Wm)(U,{variant:"primary",squared:"",onClick:W.SaveSettingHandler},{default:(0,t.w5)((()=>[(0,t.Uk)("儲存設定")])),_:1},8,["onClick"]),(0,t.Wm)(U,{variant:"info",squared:"",class:"mx-2",onClick:W.AddNewEqHandler},{default:(0,t.w5)((()=>[(0,t.Uk)("新增設備")])),_:1},8,["onClick"]),(0,t.Wm)(U,{squared:"",onClick:W.ReloadSettingsHandler},{default:(0,t.w5)((()=>[(0,t.Uk)("重新載入")])),_:1},8,["onClick"])])):(0,t.kq)("",!0),"eq-group"==E.displayMode?((0,t.wg)(),(0,t.iD)("p",u,[(0,t.Wm)(U,{variant:"primary",squared:"",onClick:W.SaveSettingHandler},{default:(0,t.w5)((()=>[(0,t.Uk)("儲存設定")])),_:1},8,["onClick"]),(0,t.Wm)(U,{variant:"info",squared:"",class:"mx-2",onClick:W.AddNewEqHandler},{default:(0,t.w5)((()=>[(0,t.Uk)("新增群組")])),_:1},8,["onClick"]),(0,t.Wm)(U,{squared:"",onClick:W.ReloadSettingsHandler},{default:(0,t.w5)((()=>[(0,t.Uk)("重新載入")])),_:1},8,["onClick"])])):(0,t.kq)("",!0),(0,t.Wm)(v,{modelValue:E.displayMode,"onUpdate:modelValue":l[0]||(l[0]=e=>E.displayMode=e)},{default:(0,t.w5)((()=>[(0,t.Wm)(O,{size:"large",label:"設備列表",value:"eq-list"}),(0,t.Wm)(O,{size:"large",label:"設備群組",value:"eq-group"})])),_:1},8,["modelValue"])]),(0,t.wy)((0,t.Wm)(D,null,null,512),[[o.F8,"eq-group"==E.displayMode]]),(0,t.wy)((0,t.Wm)(I,{"header-cell-style":{color:"white",backgroundColor:"rgb(13, 110, 253)",fontSize:"12px"},data:E.EqDatas,"row-key":E.rowKey,size:"small",border:"","scrollbar-always-on":"",height:"77vh","table-layout":"fixed",ref:"eqTable",style:{width:"100vw"}},{default:(0,t.w5)((()=>[(0,t.Wm)(y,{label:"Index",prop:"index",width:"80",align:"center",fixed:"left"}),(0,t.Wm)(y,{label:"設備名稱",prop:"Name",width:"210",fixed:"left"},{default:(0,t.w5)((e=>[(0,t._)("div",m,[(0,t.Wm)(k,{state:E.ValidName(e.row),modelValue:e.row.Name,"onUpdate:modelValue":l=>e.row.Name=l,placeholder:"設備名稱",style:{width:"160px"},"no-wheel":!0,size:"sm",min:1,onInput:l=>W.HandleEqNameChange(e.row,e.row.Name)},null,8,["state","modelValue","onUpdate:modelValue","onInput"]),(0,t.Wm)(S,{class:"my-1",size:"small",onClick:l=>W.HandleUseMapDataDisplayName(e.row.TagID)},{default:(0,t.w5)((()=>[(0,t.Uk)("使用圖資設定")])),_:2},1032,["onClick"])])])),_:1}),(0,t.Wm)(y,{label:"層",prop:"Height",width:"80",align:"center",fixed:"left"},{default:(0,t.w5)((e=>[(0,t.Wm)(A,{modelValue:e.row.Height,"onUpdate:modelValue":l=>e.row.Height=l},{default:(0,t.w5)((()=>[(0,t.Wm)(H,{label:"1",value:0}),(0,t.Wm)(H,{label:"2",value:1})])),_:2},1032,["modelValue","onUpdate:modelValue"])])),_:1}),(0,t.Wm)(y,{label:"Tag ID",prop:"TagID",width:"120",align:"center",fixed:"left"},{default:(0,t.w5)((e=>[(0,t.Wm)(k,{type:"number",state:E.ValidTag(e.row),modelValue:e.row.TagID,"onUpdate:modelValue":l=>e.row.TagID=l,modelModifiers:{number:!0},placeholder:"tag id",size:"sm",min:1},null,8,["state","modelValue","onUpdate:modelValue"])])),_:1}),(0,t.Wm)(y,{label:"下游設備",width:"850"},{default:(0,t.w5)((e=>[(0,t._)("div",r,[(0,t.Wm)(A,{size:"small",modelValue:e.row.ValidDownStreamEndPointNames,"onUpdate:modelValue":l=>e.row.ValidDownStreamEndPointNames=l,multiple:"",placeholder:"Select",style:{width:"1000px"}},{default:(0,t.w5)((()=>[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(W.GetAvaluableEqNameList(e.row.Name),(e=>((0,t.wg)(),(0,t.j4)(H,{key:e,label:e,value:e},null,8,["label","value"])))),128))])),_:2},1032,["modelValue","onUpdate:modelValue"]),(0,t.Wm)(S,{class:"mx-1",size:"small",type:"default",onClick:()=>{e.row.ValidDownStreamEndPointNames=W.GetAvaluableEqNameList(e.row.Name)}},{default:(0,t.w5)((()=>[(0,t.Uk)("使用所有設備")])),_:2},1032,["onClick"]),(0,t.Wm)(S,{size:"small",type:"danger",onClick:()=>{e.row.ValidDownStreamEndPointNames=[]}},{default:(0,t.w5)((()=>[(0,t.Uk)("清除")])),_:2},1032,["onClick"])])])),_:1}),(0,t.Wm)(y,{label:"允入車款",width:"120"},{default:(0,t.w5)((e=>[(0,t.Wm)(A,{size:"small",modelValue:e.row.Accept_AGV_Type,"onUpdate:modelValue":l=>e.row.Accept_AGV_Type=l},{default:(0,t.w5)((()=>[(0,t.Wm)(H,{value:0,label:"0-不限"}),(0,t.Wm)(H,{value:1,label:"1-叉車AGV"}),(0,t.Wm)(H,{value:2,label:"2-潛盾AGV"})])),_:2},1032,["modelValue","onUpdate:modelValue"])])),_:1}),(0,t.Wm)(y,{label:"可移載貨物類型",width:"130"},{default:(0,t.w5)((e=>[(0,t.Wm)(A,{size:"small",modelValue:e.row.EQAcceeptCargoType,"onUpdate:modelValue":l=>e.row.EQAcceeptCargoType=l},{default:(0,t.w5)((()=>[(0,t.Wm)(H,{value:0,label:"0-不限"}),(0,t.Wm)(H,{value:200,label:"200-Tray"}),(0,t.Wm)(H,{value:201,label:"201-子母框"})])),_:2},1032,["modelValue","onUpdate:modelValue"])])),_:1}),(0,t.Wm)(y,{label:"具貨物升降機構",width:"100",align:"center"},{default:(0,t.w5)((e=>[(0,t.Wm)(T,{modelValue:e.row.HasCstSteeringMechanism,"onUpdate:modelValue":l=>e.row.HasCstSteeringMechanism=l},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),(0,t.Wm)(y,{label:"雙Port設備",width:"100",align:"center"},{default:(0,t.w5)((e=>[(0,t.Wm)(T,{modelValue:e.row.IsOneOfDualPorts,"onUpdate:modelValue":l=>e.row.IsOneOfDualPorts=l},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),(0,t.Wm)(y,{label:"AnotherPortTagNumber",width:"80",align:"center"},{default:(0,t.w5)((e=>[(0,t.Wm)(R,{type:"number",modelValue:e.row.AnotherPortTagNumber,"onUpdate:modelValue":l=>e.row.AnotherPortTagNumber=l,disabled:!e.row.IsOneOfDualPorts},null,8,["modelValue","onUpdate:modelValue","disabled"])])),_:1}),(0,t.Wm)(y,{label:"可取貨狀態識別碼",width:"80",align:"center"},{default:(0,t.w5)((e=>[(0,t.Wm)(R,{type:"number",modelValue:e.row.AllowUnloadPortTypeNumber,"onUpdate:modelValue":l=>e.row.AllowUnloadPortTypeNumber=l,disabled:!e.row.IsOneOfDualPorts},null,8,["modelValue","onUpdate:modelValue","disabled"])])),_:1}),(0,t.Wm)(y,{label:"空框/實框 訊號檢查",width:"100",align:"center"},{default:(0,t.w5)((e=>[(0,t.Wm)(T,{modelValue:e.row.RackCapcityCheck,"onUpdate:modelValue":l=>e.row.RackCapcityCheck=l},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),(0,t.Wm)(y,{label:"操作","min-width":"100",fixed:"right"},{default:(0,t.w5)((e=>[(0,t._)("div",null,[(0,t.Wm)(S,{size:"small",type:"default",onClick:l=>W.ConnectionSettingBtnHandle(e.row)},{default:(0,t.w5)((()=>[(0,t.Uk)("連線設定")])),_:2},1032,["onClick"]),(0,t.Wm)(S,{size:"small",type:"danger",onClick:l=>W.RemoveHandle(e.row)},{default:(0,t.w5)((()=>[(0,t.Uk)("移除")])),_:2},1032,["onClick"])])])),_:1})])),_:1},8,["header-cell-style","data","row-key"]),[[o.F8,"eq-list"==E.displayMode]]),(0,t.Wm)(L,{size:"50%","z-index":1,modelValue:E.connection_setting_drawer,"onUpdate:modelValue":l[22]||(l[22]=e=>E.connection_setting_drawer=e),title:`${E.selected_eq_option.Name}-連線設定`},{default:(0,t.w5)((()=>[(0,t._)("div",c,[(0,t.Wm)(Q,{"label-position":"left","label-width":"100"},{default:(0,t.w5)((()=>[(0,t.Wm)(N,null,{default:(0,t.w5)((()=>[(0,t.Uk)("通訊 Protocol")])),_:1}),(0,t.Wm)(P,{label:"通訊方式"},{default:(0,t.w5)((()=>[(0,t.Wm)(A,{modelValue:E.selected_eq_option.ConnOptions.ConnMethod,"onUpdate:modelValue":l[1]||(l[1]=e=>E.selected_eq_option.ConnOptions.ConnMethod=e)},{default:(0,t.w5)((()=>[(0,t.Wm)(H,{label:"Modbus TCP",value:0}),(0,t.Wm)(H,{label:"Modbus RTU",value:1}),(0,t.Wm)(H,{label:"TCP/IP",value:2}),(0,t.Wm)(H,{label:"Serial Port",value:3}),(0,t.Wm)(H,{label:"MC Protocol",value:5})])),_:1},8,["modelValue"])])),_:1}),(0,t.Wm)(P,{label:"IP"},{default:(0,t.w5)((()=>[(0,t.Wm)(R,{disabled:1==E.selected_eq_option.ConnOptions.ConnMethod,modelValue:E.selected_eq_option.ConnOptions.IP,"onUpdate:modelValue":l[2]||(l[2]=e=>E.selected_eq_option.ConnOptions.IP=e)},null,8,["disabled","modelValue"])])),_:1}),(0,t.Wm)(P,{label:"PORT"},{default:(0,t.w5)((()=>[(0,t.Wm)(R,{disabled:1==E.selected_eq_option.ConnOptions.ConnMethod,modelValue:E.selected_eq_option.ConnOptions.Port,"onUpdate:modelValue":l[3]||(l[3]=e=>E.selected_eq_option.ConnOptions.Port=e),modelModifiers:{number:!0}},null,8,["disabled","modelValue"])])),_:1}),(0,t.Wm)(P,{label:"COMPORT"},{default:(0,t.w5)((()=>[(0,t.Wm)(R,{disabled:0==E.selected_eq_option.ConnOptions.ConnMethod,modelValue:E.selected_eq_option.ConnOptions.ComPort,"onUpdate:modelValue":l[4]||(l[4]=e=>E.selected_eq_option.ConnOptions.ComPort=e)},null,8,["disabled","modelValue"])])),_:1}),(0,t.Wm)(S,{loading:E.connection_testing,type:"default",onClick:l[5]||(l[5]=e=>W.ConnectTestHandle(E.selected_eq_option))},{default:(0,t.w5)((()=>[(0,t.Uk)("通訊測試")])),_:1},8,["loading"]),(0,t.Wm)(N,null,{default:(0,t.w5)((()=>[(0,t.Uk)("IO位置")])),_:1}),(0,t.Wm)(P,{label:"IO數量"},{default:(0,t.w5)((()=>[(0,t.Wm)(R,{type:"number",modelValue:E.selected_eq_option.ConnOptions.Input_RegisterNum,"onUpdate:modelValue":l[6]||(l[6]=e=>E.selected_eq_option.ConnOptions.Input_RegisterNum=e)},null,8,["modelValue"])])),_:1}),(0,t.Wm)(P,{label:"PLC Base"},{default:(0,t.w5)((()=>[(0,t.Wm)(T,{modelValue:E.selected_eq_option.ConnOptions.IsPLCAddress_Base_1,"onUpdate:modelValue":l[7]||(l[7]=e=>E.selected_eq_option.ConnOptions.IsPLCAddress_Base_1=e)},null,8,["modelValue"])])),_:1}),(0,t._)("div",p,[(0,t._)("div",w,[g,(0,t.Wm)(Q,{"label-position":"left","label-width":"120"},{default:(0,t.w5)((()=>[(0,t.Wm)(P,{label:"Start Index"},{default:(0,t.w5)((()=>[(0,t.Wm)(R,{type:"number",modelValue:E.selected_eq_option.ConnOptions.Input_StartRegister,"onUpdate:modelValue":l[8]||(l[8]=e=>E.selected_eq_option.ConnOptions.Input_StartRegister=e)},null,8,["modelValue"])])),_:1}),(0,t.Wm)(N),(0,t.Wm)(P,{label:"Load_Request"},{default:(0,t.w5)((()=>[(0,t.Wm)(R,{type:"number",modelValue:E.selected_eq_option.IOLocation.Load_Request,"onUpdate:modelValue":l[9]||(l[9]=e=>E.selected_eq_option.IOLocation.Load_Request=e)},null,8,["modelValue"])])),_:1}),(0,t.Wm)(P,{label:"Unload_Request"},{default:(0,t.w5)((()=>[(0,t.Wm)(R,{type:"number",modelValue:E.selected_eq_option.IOLocation.Unload_Request,"onUpdate:modelValue":l[10]||(l[10]=e=>E.selected_eq_option.IOLocation.Unload_Request=e)},null,8,["modelValue"])])),_:1}),(0,t.Wm)(P,{label:"Port_Exist"},{default:(0,t.w5)((()=>[(0,t.Wm)(R,{type:"number",modelValue:E.selected_eq_option.IOLocation.Port_Exist,"onUpdate:modelValue":l[11]||(l[11]=e=>E.selected_eq_option.IOLocation.Port_Exist=e)},null,8,["modelValue"])])),_:1}),(0,t.Wm)(P,{label:"Up_Pose"},{default:(0,t.w5)((()=>[(0,t.Wm)(R,{type:"number",modelValue:E.selected_eq_option.IOLocation.Up_Pose,"onUpdate:modelValue":l[12]||(l[12]=e=>E.selected_eq_option.IOLocation.Up_Pose=e)},null,8,["modelValue"])])),_:1}),(0,t.Wm)(P,{label:"Down_Pose"},{default:(0,t.w5)((()=>[(0,t.Wm)(R,{type:"number",modelValue:E.selected_eq_option.IOLocation.Down_Pose,"onUpdate:modelValue":l[13]||(l[13]=e=>E.selected_eq_option.IOLocation.Down_Pose=e)},null,8,["modelValue"])])),_:1}),(0,t.Wm)(P,{label:"Eqp_Status_Down"},{default:(0,t.w5)((()=>[(0,t.Wm)(R,{type:"number",modelValue:E.selected_eq_option.IOLocation.Eqp_Status_Down,"onUpdate:modelValue":l[14]||(l[14]=e=>E.selected_eq_option.IOLocation.Eqp_Status_Down=e)},null,8,["modelValue"])])),_:1}),(0,t.Wm)(P,{label:"Eqp_Maintaining"},{default:(0,t.w5)((()=>[(0,t.Wm)(R,{type:"number",modelValue:E.selected_eq_option.IOLocation.Eqp_Maintaining,"onUpdate:modelValue":l[15]||(l[15]=e=>E.selected_eq_option.IOLocation.Eqp_Maintaining=e)},null,8,["modelValue"])])),_:1}),(0,t.Wm)(P,{label:"Eqp_PartsReplacing"},{default:(0,t.w5)((()=>[(0,t.Wm)(R,{type:"number",modelValue:E.selected_eq_option.IOLocation.Eqp_PartsReplacing,"onUpdate:modelValue":l[16]||(l[16]=e=>E.selected_eq_option.IOLocation.Eqp_PartsReplacing=e)},null,8,["modelValue"])])),_:1})])),_:1})]),(0,t._)("div",q,[V,(0,t.Wm)(Q,{"label-position":"left","label-width":"120"},{default:(0,t.w5)((()=>[(0,t.Wm)(P,{label:"Start Index"},{default:(0,t.w5)((()=>[(0,t.Wm)(R,{type:"number",modelValue:E.selected_eq_option.ConnOptions.Output_Start_Address,"onUpdate:modelValue":l[17]||(l[17]=e=>E.selected_eq_option.ConnOptions.Output_Start_Address=e)},null,8,["modelValue"])])),_:1}),(0,t.Wm)(N),(0,t.Wm)(P,{label:"To_EQ_Up"},{default:(0,t.w5)((()=>[(0,t.Wm)(R,{type:"number",modelValue:E.selected_eq_option.IOLocation.To_EQ_Up,"onUpdate:modelValue":l[18]||(l[18]=e=>E.selected_eq_option.IOLocation.To_EQ_Up=e)},null,8,["modelValue"])])),_:1}),(0,t.Wm)(P,{label:"To_EQ_Low"},{default:(0,t.w5)((()=>[(0,t.Wm)(R,{type:"number",modelValue:E.selected_eq_option.IOLocation.To_EQ_Low,"onUpdate:modelValue":l[19]||(l[19]=e=>E.selected_eq_option.IOLocation.To_EQ_Low=e)},null,8,["modelValue"])])),_:1}),(0,t.Wm)(P,{label:"CMD_Reserve_Up"},{default:(0,t.w5)((()=>[(0,t.Wm)(R,{type:"number",modelValue:E.selected_eq_option.IOLocation.CMD_Reserve_Up,"onUpdate:modelValue":l[20]||(l[20]=e=>E.selected_eq_option.IOLocation.CMD_Reserve_Up=e)},null,8,["modelValue"])])),_:1}),(0,t.Wm)(P,{label:"CMD_Reserve_Low"},{default:(0,t.w5)((()=>[(0,t.Wm)(R,{type:"number",modelValue:E.selected_eq_option.IOLocation.CMD_Reserve_Low,"onUpdate:modelValue":l[21]||(l[21]=e=>E.selected_eq_option.IOLocation.CMD_Reserve_Low=e)},null,8,["modelValue"])])),_:1})])),_:1})])])])),_:1})])])),_:1},8,["modelValue","title"]),(0,t.Wm)(L,{modelValue:E.io_check_drawer,"onUpdate:modelValue":l[36]||(l[36]=e=>E.io_check_drawer=e),direction:"btt"},{default:(0,t.w5)((()=>[(0,t._)("div",h,[f,(0,t._)("div",{class:"di-status",onClick:l[23]||(l[23]=l=>e.HandleHSsignaleChange(W.selected_eq_io_data.EQName,"L_REQ",!e.scope.row.HS_EQ_L_REQ)),style:(0,n.j5)(e.signalOn(W.selected_eq_io_data.HS_EQ_L_REQ))},"L_REQ",4),(0,t._)("div",{class:"di-status",onClick:l[24]||(l[24]=l=>e.HandleHSsignaleChange(W.selected_eq_io_data.EQName,"U_REQ",!e.scope.row.HS_EQ_U_REQ)),style:(0,n.j5)(e.signalOn(W.selected_eq_io_data.HS_EQ_U_REQ))},"U_REQ",4),(0,t._)("div",{class:"di-status",onClick:l[25]||(l[25]=l=>e.HandleHSsignaleChange(W.selected_eq_io_data.EQName,"READY",!e.scope.row.HS_EQ_READY)),style:(0,n.j5)(e.signalOn(W.selected_eq_io_data.HS_EQ_READY))},"READY",4),(0,t._)("div",{class:"di-status",onClick:l[26]||(l[26]=l=>e.HandleHSsignaleChange(W.selected_eq_io_data.EQName,"UP_READY",!e.scope.row.HS_EQ_UP_READY)),style:(0,n.j5)(e.signalOn(W.selected_eq_io_data.HS_EQ_UP_READY))},"UP_READY",4),(0,t._)("div",{class:"di-status",onClick:l[27]||(l[27]=l=>e.HandleHSsignaleChange(W.selected_eq_io_data.EQName,"LOW_READY",!e.scope.row.HS_EQ_LOW_READY)),style:(0,n.j5)(e.signalOn(W.selected_eq_io_data.HS_EQ_LOW_READY))},"LOW_READY",4),(0,t.kq)("",!0)]),(0,t._)("div",C,[b,(0,t._)("div",{class:"di-status",onClick:l[29]||(l[29]=l=>e.HandleAGVHSSignaleChange(W.selected_eq_io_data.EQName,"To_EQ_Up",!e.scope.row.To_EQ_Up)),style:(0,n.j5)(e.signalOn(W.selected_eq_io_data.To_EQ_Up))},"To_EQ_Up",4),(0,t._)("div",{class:"di-status",onClick:l[30]||(l[30]=l=>e.HandleAGVHSSignaleChange(W.selected_eq_io_data.EQName,"To_EQ_Low",!e.scope.row.To_EQ_Low)),style:(0,n.j5)(e.signalOn(W.selected_eq_io_data.To_EQ_Low))},"To_EQ_Low",4),(0,t._)("div",{class:"di-status",onClick:l[31]||(l[31]=l=>e.HandleAGVHSSignaleChange(W.selected_eq_io_data.EQName,"VALID",!e.scope.row.HS_AGV_VALID)),style:(0,n.j5)(e.signalOn(W.selected_eq_io_data.HS_AGV_VALID))},"VALID",4),(0,t._)("div",{class:"di-status",onClick:l[32]||(l[32]=l=>e.HandleAGVHSSignaleChange(W.selected_eq_io_data.EQName,"TR_REQ",!e.scope.row.HS_AGV_TR_REQ)),style:(0,n.j5)(e.signalOn(W.selected_eq_io_data.HS_AGV_TR_REQ))},"TR_REQ",4),(0,t._)("div",{class:"di-status",onClick:l[33]||(l[33]=l=>e.HandleAGVHSSignaleChange(W.selected_eq_io_data.EQName,"BUSY",!e.scope.row.HS_AGV_BUSY)),style:(0,n.j5)(e.signalOn(W.selected_eq_io_data.HS_AGV_BUSY))},"BUSY",4),(0,t.kq)("",!0),(0,t._)("div",{class:"di-status",onClick:l[35]||(l[35]=l=>e.HandleAGVHSSignaleChange(W.selected_eq_io_data.EQName,"COMPT",!e.scope.row.HS_AGV_COMPT)),style:(0,n.j5)(e.signalOn(W.selected_eq_io_data.HS_AGV_COMPT))},"COMPT",4)])])),_:1},8,["modelValue"])])),[[x,E.loading]])}a(57658);var W=a(64491),U=a(91747);const O={class:"eq-group-editor"},v={class:"groups-container"};function D(e,l,a,o,n,d){const s=(0,t.up)("GroupComponent");return(0,t.wg)(),(0,t.iD)("div",O,[(0,t.Uk)(" EQ Group "),(0,t._)("div",v,[(0,t.Wm)(s,{class:"group"}),(0,t.Wm)(s,{class:"group"}),(0,t.Wm)(s,{class:"group"}),(0,t.Wm)(s,{class:"group"}),(0,t.Wm)(s,{class:"group"}),(0,t.Wm)(s,{class:"group"}),(0,t.Wm)(s,{class:"group"}),(0,t.Wm)(s,{class:"group",onOnAddClick:d.HandleAddRequest,isUseForAdd:!0},null,8,["onOnAddClick"])])])}const y=e=>((0,t.dD)("data-v-853a49ca"),e=e(),(0,t.Cn)(),e),k=y((()=>(0,t._)("i",{class:"bi bi-plus-circle"},null,-1))),S={key:1};function H(e,l,a,o,d,s){const i=(0,t.up)("el-tooltip");return(0,t.wg)(),(0,t.iD)("div",{class:(0,n.C_)(["eq-group-component",a.isUseForAdd?"addable-layout":""])},[a.isUseForAdd?((0,t.wg)(),(0,t.iD)("div",{key:0,class:"add-mode",onClick:l[0]||(l[0]=(...e)=>s.HandleAddRegionClicked&&s.HandleAddRegionClicked(...e))},[(0,t.Wm)(i,{content:"新增一個設備群組",placement:"top"},{default:(0,t.w5)((()=>[k])),_:1})])):((0,t.wg)(),(0,t.iD)("div",S,"Content"))],2)}var A={props:{isUseForAdd:{type:Boolean,default:!1}},methods:{HandleAddRegionClicked(){this.$emit("onAddClick","")}}},T=a(83744);const R=(0,T.Z)(A,[["render",H],["__scopeId","data-v-853a49ca"]]);var I=R,N={components:{GroupComponent:I},methods:{HandleAddRequest(){alert("Add a group.")}}};const P=(0,T.Z)(N,[["render",D],["__scopeId","data-v-76972d4a"]]);var Q=P,L=a(95320),x=a(25044),M=a(49996),G=(a(30381),a(78538)),z={components:{RegionsSelector:U.Z,EqGroupEditor:Q},data(){return{displayMode:"eq-group",cell_item_size:"",io_check_drawer:!1,connection_setting_drawer:!1,EqDatas:[],EqDatas_Orignal:[],ValidTag:e=>!0,ValidName:e=>{var l=e.Name,a=this.EqDatas.filter((l=>l.Name==e.Name));return 1==a.length&&""!=l},selected_eq_option:new G.W,connection_testing:!1,loading:!0,rowKey:"index"}},watch:{displayMode(e){}},methods:{GetAvaluableEqNameList(e){var l=this.EqNames.filter((l=>l!=e));return["ALL",...l]},async SaveSettingHandler(){var e=this.ValidateSetting();if(e.confirm){var l=await(0,W.wW)(this.EqDatas);l.confirm?(setTimeout((()=>{this.ReloadSettingsHandler(!1)}),200),this.$swal.fire({title:"儲存成功",icon:"success",timer:2e3})):this.$swal.fire({title:"參數設定有誤",text:l.message,icon:"error"})}else this.$swal.fire({text:"",title:e.message,icon:"error",showCancelButton:!1,confirmButtonText:"OK",customClass:"my-sweetalert"})},ValidateSetting(){const e=this.EqDatas.length;var l=[...new Set(this.EqDatas.map((e=>e.TagID+"-"+e.Height)))];const a=l.length==e;return{confirm:a,message:"同一個TAG不可有相同的層設置"}},async DownloadEQOptions(){this.EqDatas=[];var e=x.jU.state.EqOptions;for(let a=0;a<e.length;a++){var l=new G.W;Object.assign(l,e[a]),l.index=a,this.EqDatas.push(l)}this.CloneEQDatas()},CloneEQDatas(){this.EqDatas_Orignal=JSON.parse(JSON.stringify(this.EqDatas))},ReloadSettingsHandler(e=!0){this.loading=e,setTimeout((()=>{(0,W.H5)().then((e=>x.jU.commit("EqOptions",e))),this.DownloadEQOptions(),this.$refs.eqTable.setScrollTop(0),this.loading=!1}),300)},AddNewEqHandler(){let e=new G.W;e.TagID=1,e.index=this.EqDatas.length,this.EqDatas=[e,...this.EqDatas],setTimeout((()=>{this.$refs.eqTable.setScrollTop(0)}),300)},RemoveHandle(e){var l=this.EqDatas.filter((l=>l.Name!=e.Name));this.EqDatas=l},async IOCheckBtnHandle(e){this.selected_eq_option=e,this.io_check_drawer=!0},async ConnectionSettingBtnHandle(e){this.selected_eq_option=e,this.connection_setting_drawer=!0},async ConnectTestHandle(e){this.connection_testing=!0;var l=await(0,W.qN)(e.ConnOptions);this.connection_testing=!1;var a="";a=0==e.ConnOptions.ConnMethod?`Modbus TCP - ${e.ConnOptions.IP}:${e.ConnOptions.Port}`:`Modbus RTU - ${e.ConnOptions.ComPort}`,l.Connected?this.$swal.fire({title:"OK",text:a,icon:"success"}):this.$swal.fire({title:"Fail",text:a,icon:"error"})},beforeRouteLeave(e,l,a){alert("leave!")},async HandleUseMapDataDisplayName(e){var l=await L.p.dispatch("GetMapPointByTag",e);if(l){var a=this.EqDatas.find((l=>l.TagID==e)),t=l.Graph.Display;a.Name=t,this.HandleEqNameChange(a,t),(0,M.bM)({message:`Get Display Name From Map Success(Tag ${e} = ${t})`,duration:1e3,type:"success",title:"設備同步名稱"})}else(0,M.bM)({message:"Get Display Name From Map Fail",duration:1e3,type:"error",title:"設備同步名稱失敗"})},HandleEqNameChange(e,l){var a=e.TagID,t=this.EqDatas_Orignal.find((e=>e.TagID==a));if(t){var o=t.Name,n=this.EqDatas.filter((e=>e.ValidDownStreamEndPointNames.includes(o)));n.forEach((e=>{var a=e.ValidDownStreamEndPointNames.indexOf(o);e.ValidDownStreamEndPointNames[a]=l})),this.CloneEQDatas()}}},mounted(){setTimeout((()=>{this.DownloadEQOptions(),this.loading=!1}),400)},computed:{EqNames(){return this.EqDatas.map((e=>e.Name))},eq_data(){return x.jU.getters.EQData},selected_eq_io_data(){return this.eq_data.find((e=>e.EQName==this.selected_eq_option.EQName))}}};const Y=(0,T.Z)(z,[["render",E],["__scopeId","data-v-4268033e"]]);var j=Y}}]);
//# sourceMappingURL=640.dcaa65d2.js.map